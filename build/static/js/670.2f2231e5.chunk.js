"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[670],{4186:(e,t,r)=>{r.d(t,{c:()=>s});const s=e=>{let{IDL:t}=e;const r=t.Record({owner:t.Principal,subaccount:t.Opt(t.Vec(t.Nat8))}),s=t.Record({icrc2:t.Bool}),a=t.Record({icrc1_minting_account:t.Opt(r),feature_flags:t.Opt(s)}),n=t.Record({e8s:t.Nat64}),l=t.Record({secs:t.Nat64,nanos:t.Nat32}),i=t.Record({num_blocks_to_archive:t.Nat64,max_transactions_per_response:t.Opt(t.Nat64),trigger_threshold:t.Nat64,more_controller_ids:t.Opt(t.Vec(t.Principal)),max_message_size_bytes:t.Opt(t.Nat64),cycles_for_archive_creation:t.Opt(t.Nat64),node_max_memory_size_bytes:t.Opt(t.Nat64),controller_id:t.Principal}),c=t.Record({send_whitelist:t.Vec(t.Principal),token_symbol:t.Opt(t.Text),transfer_fee:t.Opt(n),minting_account:t.Text,maximum_number_of_accounts:t.Opt(t.Nat64),accounts_overflow_trim_quantity:t.Opt(t.Nat64),transaction_window:t.Opt(l),max_message_size_bytes:t.Opt(t.Nat64),icrc1_minting_account:t.Opt(r),archive_options:t.Opt(i),initial_values:t.Vec(t.Tuple(t.Text,n)),token_name:t.Opt(t.Text),feature_flags:t.Opt(s)}),o=(t.Variant({Upgrade:t.Opt(a),Init:c}),t.Record({account:t.Vec(t.Nat8)})),d=t.Record({account:t.Text}),u=t.Record({canister_id:t.Principal}),x=t.Record({archives:t.Vec(u)}),f=t.Record({decimals:t.Nat32}),m=t.Record({url:t.Text,name:t.Text}),p=t.Variant({Int:t.Int,Nat:t.Nat,Blob:t.Vec(t.Nat8),Text:t.Text}),g=t.Record({to:r,fee:t.Opt(t.Nat),memo:t.Opt(t.Vec(t.Nat8)),from_subaccount:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(t.Nat64),amount:t.Nat}),h=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,BadBurn:t.Record({min_burn_amount:t.Nat}),Duplicate:t.Record({duplicate_of:t.Nat}),BadFee:t.Record({expected_fee:t.Nat}),CreatedInFuture:t.Record({ledger_time:t.Nat64}),TooOld:t.Null,InsufficientFunds:t.Record({balance:t.Nat})}),v=t.Variant({Ok:t.Nat,Err:h}),N=t.Record({utc_offset_minutes:t.Opt(t.Int16),language:t.Text}),_=t.Variant({GenericDisplay:t.Null,LineDisplay:t.Record({characters_per_line:t.Nat16,lines_per_page:t.Nat16})}),b=t.Record({metadata:N,device_spec:t.Opt(_)}),y=t.Record({arg:t.Vec(t.Nat8),method:t.Text,user_preferences:b}),j=t.Record({lines:t.Vec(t.Text)}),w=t.Variant({LineDisplayMessage:t.Record({pages:t.Vec(j)}),GenericDisplayMessage:t.Text}),k=t.Record({metadata:N,consent_message:w}),O=t.Record({description:t.Text}),T=t.Variant({GenericError:t.Record({description:t.Text,error_code:t.Nat}),InsufficientPayment:O,UnsupportedCanisterCall:O,ConsentMessageUnavailable:O}),S=t.Variant({Ok:k,Err:T}),R=t.Record({account:r,spender:r}),F=t.Record({allowance:t.Nat,expires_at:t.Opt(t.Nat64)}),V=t.Record({fee:t.Opt(t.Nat),memo:t.Opt(t.Vec(t.Nat8)),from_subaccount:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(t.Nat64),amount:t.Nat,expected_allowance:t.Opt(t.Nat),expires_at:t.Opt(t.Nat64),spender:r}),C=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,Duplicate:t.Record({duplicate_of:t.Nat}),BadFee:t.Record({expected_fee:t.Nat}),AllowanceChanged:t.Record({current_allowance:t.Nat}),CreatedInFuture:t.Record({ledger_time:t.Nat64}),TooOld:t.Null,Expired:t.Record({ledger_time:t.Nat64}),InsufficientFunds:t.Record({balance:t.Nat})}),A=t.Variant({Ok:t.Nat,Err:C}),I=t.Record({to:r,fee:t.Opt(t.Nat),spender_subaccount:t.Opt(t.Vec(t.Nat8)),from:r,memo:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(t.Nat64),amount:t.Nat}),q=t.Variant({GenericError:t.Record({message:t.Text,error_code:t.Nat}),TemporarilyUnavailable:t.Null,InsufficientAllowance:t.Record({allowance:t.Nat}),BadBurn:t.Record({min_burn_amount:t.Nat}),Duplicate:t.Record({duplicate_of:t.Nat}),BadFee:t.Record({expected_fee:t.Nat}),CreatedInFuture:t.Record({ledger_time:t.Nat64}),TooOld:t.Null,InsufficientFunds:t.Record({balance:t.Nat})}),D=t.Variant({Ok:t.Nat,Err:q}),B=t.Record({name:t.Text}),E=t.Record({start:t.Nat64,length:t.Nat64}),P=t.Record({timestamp_nanos:t.Nat64}),U=t.Variant({Approve:t.Record({fee:n,from:t.Vec(t.Nat8),allowance_e8s:t.Int,allowance:n,expected_allowance:t.Opt(n),expires_at:t.Opt(P),spender:t.Vec(t.Nat8)}),Burn:t.Record({from:t.Vec(t.Nat8),amount:n,spender:t.Opt(t.Vec(t.Nat8))}),Mint:t.Record({to:t.Vec(t.Nat8),amount:n}),Transfer:t.Record({to:t.Vec(t.Nat8),fee:n,from:t.Vec(t.Nat8),amount:n,spender:t.Opt(t.Vec(t.Nat8))})}),z=t.Record({memo:t.Nat64,icrc1_memo:t.Opt(t.Vec(t.Nat8)),operation:t.Opt(U),created_at_time:P}),M=t.Record({transaction:z,timestamp:P,parent_hash:t.Opt(t.Vec(t.Nat8))}),L=t.Record({blocks:t.Vec(M)}),K=t.Variant({BadFirstBlockIndex:t.Record({requested_index:t.Nat64,first_valid_index:t.Nat64}),Other:t.Record({error_message:t.Text,error_code:t.Nat64})}),W=t.Variant({Ok:L,Err:K}),$=t.Record({callback:t.Func([E],[W],["query"]),start:t.Nat64,length:t.Nat64}),G=t.Record({certificate:t.Opt(t.Vec(t.Nat8)),blocks:t.Vec(M),chain_length:t.Nat64,first_block_index:t.Nat64,archived_blocks:t.Vec($)}),X=t.Variant({Ok:t.Vec(t.Vec(t.Nat8)),Err:K}),J=t.Record({callback:t.Func([E],[X],["query"]),start:t.Nat64,length:t.Nat64}),Z=t.Record({certificate:t.Opt(t.Vec(t.Nat8)),blocks:t.Vec(t.Vec(t.Nat8)),chain_length:t.Nat64,first_block_index:t.Nat64,archived_blocks:t.Vec(J)}),H=t.Record({to:t.Text,fee:n,memo:t.Nat64,from_subaccount:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(P),amount:n}),Y=t.Record({symbol:t.Text}),Q=t.Record({to:t.Vec(t.Nat8),fee:n,memo:t.Nat64,from_subaccount:t.Opt(t.Vec(t.Nat8)),created_at_time:t.Opt(P),amount:n}),ee=t.Variant({TxTooOld:t.Record({allowed_window_nanos:t.Nat64}),BadFee:t.Record({expected_fee:n}),TxDuplicate:t.Record({duplicate_of:t.Nat64}),TxCreatedInFuture:t.Null,InsufficientFunds:t.Record({balance:n})}),te=t.Variant({Ok:t.Nat64,Err:ee}),re=t.Record({transfer_fee:n});return t.Service({account_balance:t.Func([o],[n],["query"]),account_balance_dfx:t.Func([d],[n],["query"]),account_identifier:t.Func([r],[t.Vec(t.Nat8)],["query"]),archives:t.Func([],[x],["query"]),decimals:t.Func([],[f],["query"]),icrc10_supported_standards:t.Func([],[t.Vec(m)],["query"]),icrc1_balance_of:t.Func([r],[t.Nat],["query"]),icrc1_decimals:t.Func([],[t.Nat8],["query"]),icrc1_fee:t.Func([],[t.Nat],["query"]),icrc1_metadata:t.Func([],[t.Vec(t.Tuple(t.Text,p))],["query"]),icrc1_minting_account:t.Func([],[t.Opt(r)],["query"]),icrc1_name:t.Func([],[t.Text],["query"]),icrc1_supported_standards:t.Func([],[t.Vec(m)],["query"]),icrc1_symbol:t.Func([],[t.Text],["query"]),icrc1_total_supply:t.Func([],[t.Nat],["query"]),icrc1_transfer:t.Func([g],[v],[]),icrc21_canister_call_consent_message:t.Func([y],[S],[]),icrc2_allowance:t.Func([R],[F],["query"]),icrc2_approve:t.Func([V],[A],[]),icrc2_transfer_from:t.Func([I],[D],[]),name:t.Func([],[B],["query"]),query_blocks:t.Func([E],[G],["query"]),query_encoded_blocks:t.Func([E],[Z],["query"]),send_dfx:t.Func([H],[t.Nat64],[]),symbol:t.Func([],[Y],["query"]),transfer:t.Func([Q],[te],[]),transfer_fee:t.Func([t.Record({})],[re],["query"])})}},1289:(e,t,r)=>{r.d(t,{T:()=>a});var s=r(2198);function a(e,t){let r=new Uint8Array([10,116,105,100]);const a=s.Principal.fromText(t).toUint8Array();r=new Uint8Array([...r,...a]);let n=e;for(let s=3;s>=0;s--){const e=Math.pow(2,8*s),t=Math.floor(n/e);r=new Uint8Array([...r,t]),n-=t*e}return s.Principal.fromUint8Array(r).toText()}},8657:(e,t,r)=>{r.d(t,{A:()=>p});var s=r(7097),a=r(5043),n=r(1935),l=r(2198),i=r(8247),c=r(2013),o=r(3216),d=r(39),u=r(1699),x=r(4230),f=r(4186),m=r(579);const p=e=>{let{nftid:t,nft_price:r,userP:p}=e;const[g,h]=(0,a.useState)(!1),[v,N]=(0,a.useState)(!1),[_,b]=(0,a.useState)(""),[y,j]=(0,a.useState)(""),{invalidateListings:w,invalidateUserNfts:k,invalidateUserBalance:O}=(0,c.A)(),T=(0,d.fJ)(),{user:S}=(0,d._d)(),R=async(e,t)=>{b(e),j(t),N(!0),setTimeout((()=>N(!1)),3e3)},F=(0,o.Zp)(),{mutateAsync:V}=(0,s.n)({mutationFn:()=>C(),onSuccess:async()=>{w(),k(),O(),h(!1)}}),C=async()=>{try{if(!S||!T)return void R("Log in first to purchase this NFT","error");let e=(0,u.M)(n.WC,x.c,T);const s=(0,u.M)(n.tc,f.c,T);h(!0);let a=await s.icrc2_approve({fee:[],memo:[],from_subaccount:[],created_at_time:[],amount:Number(r)+2e4,expected_allowance:[],expires_at:[],spender:{owner:l.Principal.fromText(n.WC),subaccount:[]}});console.log("approve results :",a);let i=await e.buy_nft(t);200==i.status&&"Ok"==i.status_text?R("NFT purchase successful","success"):R(i.error_text,"error"),console.log("buy results :",i)}catch(e){console.log("error in buying nft :",e)}F("/profile")};return(0,m.jsxs)(m.Fragment,{children:[v&&(0,m.jsx)("div",{className:"absolute top-10 z-50 text-xs  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===y?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,m.jsx)("div",{className:"modal-message",children:(0,m.jsx)("p",{children:_})})}),(0,m.jsx)("button",{onClick:()=>V(),className:"flex w-full bg-[#2E8DEE] rounded-b-lg mt-4 font-bold text-white justify-center items-center p-2",children:g?(0,m.jsx)(i.A,{size:20,color:"white"}):"Buy"})]})}},7670:(e,t,r)=>{r.r(t),r.d(t,{default:()=>V});var s=r(3747),a=r(7097),n=r(5043),l=r(3216),i=r(1289),c=r(826),o=r(7586),d=r(1935),u=r(4230),x=r(1699),f=r(5394),m=r(8973),p=r(8247),g=r(39),h=r(4186),v=r(2198),N=r(579);const _=e=>{let{nftid:t,nft_price:r,handleTrigger:s}=e;const[l,i]=(0,n.useState)(!1),[c,o]=(0,n.useState)(!1),[f,_]=(0,n.useState)(""),[b,y]=(0,n.useState)(""),[j,w]=(0,n.useState)(!1),[k,O]=(0,n.useState)(""),[T,S]=(0,n.useState)(""),{user:R}=(0,g._d)(),F=(0,g.fJ)({retryTimes:2}),V=async(e,t)=>{O(e),S(t),w(!0),setTimeout((()=>w(!1)),3e3)},{mutateAsync:C}=(0,a.n)({mutationFn:e=>(async e=>{e.preventDefault(),o(!0);try{if(!R||!F)return;let e=(0,x.M)(d.WC,u.c,F);const r=(0,x.M)(d.tc,h.c,F);let a=await r.icrc2_approve({fee:[],memo:[],from_subaccount:[],created_at_time:[],amount:Number(1e8*f)+2e4,expected_allowance:[],expires_at:[],spender:{owner:v.Principal.fromText(d.WC),subaccount:[]}});console.log("apprive results :",a);let n=(0,d.N1)(b),l=await(null===e||void 0===e?void 0:e.place_offer_on_nft(t,Number(1e8*f),n));200==l.status&&"Ok"==l.status_text?V("Offer place successfully","success"):V(l.error_text,"error"),s(),console.log("offer results here:",l)}catch(r){console.log("error in placing offer :",r)}})(e),onSuccess:async()=>{o(!1)}});return(0,N.jsxs)("div",{className:"flex bg-[#2c2d2e] w-1/2 rounded-lg mt-4 font-bold text-white justify-center items-center p-2 cursor-pointer",children:[(0,N.jsx)("button",{onClick:()=>i(!0),children:"Make Offer"}),l&&(0,N.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:[j&&(0,N.jsx)("div",{className:"absolute top-10 text-xs z-50  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===T?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,N.jsx)("div",{className:"modal-message",children:(0,N.jsx)("p",{children:k})})}),(0,N.jsxs)("div",{className:"bg-[#252525] rounded-lg shadow-lg p-6 w-96",children:[(0,N.jsxs)("div",{className:"flex justify-between ",children:[(0,N.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Make Offer"}),(0,N.jsx)(m.PXF,{className:"cursor-pointer",onClick:()=>i(!1)})]}),(0,N.jsxs)("form",{onSubmit:C,children:[(0,N.jsx)("label",{className:"block mb-2",htmlFor:"price",children:"Enter Offer amount"}),(0,N.jsx)("input",{type:"number",id:"price",placeholder:"enter offer amount",value:f,onChange:e=>_(e.target.value),className:" border border-white text-sm text-black rounded p-1 w-full mb-4",required:!0}),(0,N.jsx)("input",{type:"number",id:"price",value:b,placeholder:"enter number of days",onChange:e=>y(e.target.value),className:" border border-white text-sm text-black rounded p-1 w-full mb-4",required:!0}),(0,N.jsx)("div",{className:"flex justify-end",children:c?(0,N.jsx)(p.A,{color:"white",size:20}):(0,N.jsx)("button",{type:"submit",className:"px-4 py-2 bg-white text-black rounded",children:"Place Offer"})})]})]})]})]})};var b=r(2013);const y=e=>{let{nftid:t,nft_price:r,userP:l}=e;const[i,c]=(0,n.useState)(!1),[o,u]=(0,n.useState)(!1),[x,f]=(0,n.useState)(""),[m,g]=(0,n.useState)(""),{invalidateListings:h,invalidateUserNfts:_,invalidateUserBalance:y}=(0,b.A)(),j=async(e,t)=>{f(e),g(t),u(!0),setTimeout((()=>u(!1)),3e3)},{data:w}=(0,s.I)({queryKey:["userPrincipal"]}),{data:k}=(0,s.I)({queryKey:["userIcpBalance"]}),{data:O}=(0,s.I)({queryKey:["allListings"]}),{data:T}=(0,s.I)({queryKey:["userNFTS"]}),{data:S}=(0,s.I)({queryKey:["nftActor"]}),{data:R}=(0,s.I)({queryKey:["marketplaceActor"]}),{data:F}=(0,s.I)({queryKey:["IcpActor"]}),{mutateAsync:V}=(0,a.n)({mutationFn:()=>C(),onSuccess:async()=>{h(),_(),y(),c(!1)}}),C=async()=>{try{if(!R)return void j("Log in first to purchase this NFT","error");c(!0);let e=await F.icrc2_approve({fee:[],memo:[],from_subaccount:[],created_at_time:[],amount:Number(r)+2e4,expected_allowance:[],expires_at:[],spender:{owner:v.Principal.fromText(d.WC),subaccount:[]}});console.log("approve results :",e);let s=await R.buy_nft(t);200==s.status&&"Ok"==s.status_text?j("NFT purchase successful","success"):j(s.error_text,"error"),console.log("buy results :",s)}catch(e){console.log("erro in buying nft :",e)}};return(0,N.jsxs)(N.Fragment,{children:[o&&(0,N.jsx)("div",{className:"absolute top-10 z-50 text-xs  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===m?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,N.jsx)("div",{className:"modal-message",children:(0,N.jsx)("p",{children:x})})}),(0,N.jsx)("button",{onClick:()=>V(),className:"flex bg-[#2E8DEE] w-1/2 rounded-lg mt-4 font-bold text-white justify-center items-center p-2",children:i?(0,N.jsx)(p.A,{size:20,color:"white"}):"Buy now"})]})},j=e=>{let{history:t}=e;const r=e=>`${null===e||void 0===e?void 0:e.slice(0,6)}...${null===e||void 0===e?void 0:e.slice(-4)}`;return(0,N.jsxs)("div",{className:"overflow-x-auto bg-[#1B1B1B] p-2 rounded-lg border border-gray-400 h-[200px] md:h-[400px]",children:[(0,N.jsx)("h3",{className:"text-lg",children:"Activity"}),(0,N.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,N.jsx)("thead",{className:"",children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Buyer"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Seller"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time"})]})}),(0,N.jsx)("tbody",{className:" divide-y divide-gray-200",children:(null===t||void 0===t?void 0:t.length)>0?null===t||void 0===t?void 0:t.map(((e,t)=>{var s,a,n;return(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:r(null===e||void 0===e||null===(s=e.buyer)||void 0===s?void 0:s.toString())}),(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:r(null===e||void 0===e||null===(a=e.seller)||void 0===a?void 0:a.toString())}),(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:Number(null===e||void 0===e?void 0:e.price)/1e8}),(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:(n=null===e||void 0===e?void 0:e.time,new Date(Number(n)/1e6).toLocaleString())})]},t)})):(0,N.jsx)("div",{className:"text-xs flex justify-center items-center ",children:"No activity available"})})]})]})},w=e=>{let{offers:t,nft:r,nftOwner:s,handleTrigger:a}=e;const i=(0,g.fJ)(),{user:c}=(0,g._d)(),o=(0,l.Zp)(),[f,h]=(0,n.useState)(!1),[v,_]=(0,n.useState)(!1),[b,y]=(0,n.useState)(null),[j,w]=(0,n.useState)(!1),[k,O]=(0,n.useState)(!1),[T,S]=(0,n.useState)(!1),[R,F]=(0,n.useState)(""),[V,C]=(0,n.useState)(""),A=async(e,t)=>{F(e),C(t),S(!0),setTimeout((()=>S(!1)),3e3)};return(0,N.jsxs)("div",{className:"overflow-x-auto mb-10 bg-[#1B1B1B] p-2 rounded-lg border border-gray-400",children:[f&&(0,N.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:[T&&(0,N.jsx)("div",{className:"absolute top-10 text-xs z-50  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===V?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,N.jsx)("div",{className:"modal-message",children:(0,N.jsx)("p",{children:R})})}),(0,N.jsxs)("div",{className:"bg-[#252525] rounded-lg flex flex-col items-center justify-center gap-1 shadow-lg p-6 w-96",children:[(0,N.jsxs)("div",{className:"flex  w-full justify-between ",children:[(0,N.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Cancel Offer"}),(0,N.jsx)(m.PXF,{className:"cursor-pointer",onClick:()=>h(!1)})]}),(0,N.jsx)("span",{children:"Proceed to cancel offer?"}),v?(0,N.jsx)(p.A,{color:"white",size:20}):(0,N.jsx)("button",{onClick:()=>(async()=>{try{_(!0);let e=(0,x.M)(d.WC,u.c,i);if(!e||!b)return;console.log(b);let t=await(null===e||void 0===e?void 0:e.cancel_offer(null===b||void 0===b?void 0:b.offer.offer_id,null===b||void 0===b?void 0:b.nft));200==t.status&&"Ok"==t.status_text?A("Offer cancelled successfully","success"):A(t.error_text,"error"),a()}catch(e){console.log("error in canceling offer :",e)}h(!1),_(!1)})(),className:"flex w-1/2 mt-2 justify-center items-center  bg-red-500 p-1 rounded-lg",children:"Confirm"})]})]}),j&&(0,N.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:[T&&(0,N.jsx)("div",{className:"absolute top-10 text-xs z-50  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===V?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,N.jsx)("div",{className:"modal-message",children:(0,N.jsx)("p",{children:R})})}),(0,N.jsxs)("div",{className:"bg-[#252525] rounded-lg flex flex-col items-center justify-center gap-1 shadow-lg p-6 w-96",children:[(0,N.jsxs)("div",{className:"flex  w-full justify-between ",children:[(0,N.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Accept Offer"}),(0,N.jsx)(m.PXF,{className:"cursor-pointer",onClick:()=>w(!1)})]}),(0,N.jsx)("span",{children:"Confirm offer?"}),k?(0,N.jsx)(p.A,{color:"white",size:20}):(0,N.jsx)("button",{onClick:()=>(async()=>{try{O(!0);let e=(0,x.M)(d.WC,u.c,i);if(!e||!b)return;console.log("selected offer :",b);let t=await(null===e||void 0===e?void 0:e.accept_offer(b.nft,b.offer.offer_id));console.log("accept nft sale :",t),200==t.status&&"Ok"==t.status_text?A("NFT sold successfully","success"):A(t.error_text,"error")}catch(e){console.log("error in accepting offer :",e)}O(!1),w(!1),o("/")})(),className:"flex w-1/2 mt-2 justify-center items-center  bg-green-500 p-1 rounded-lg",children:"Confirm"})]})]}),(0,N.jsx)("h3",{className:"text-lg",children:"Offers"}),(0,N.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,N.jsx)("thead",{className:"",children:(0,N.jsxs)("tr",{children:[(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expiry Date"}),(0,N.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),(0,N.jsx)("tbody",{className:" divide-y divide-gray-200",children:(null===t||void 0===t?void 0:t.length)>0?null===t||void 0===t?void 0:t.map(((e,t)=>{var a,n,l,i,o,d;return(0,N.jsxs)("tr",{children:[(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:(d=null===e||void 0===e||null===(a=e.user)||void 0===a?void 0:a.toString(),`${null===d||void 0===d?void 0:d.slice(0,6)}...${null===d||void 0===d?void 0:d.slice(-4)}`)}),(0,N.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:[Number(null===e||void 0===e?void 0:e.amount)/1e8," ICP"]}),(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:(o=Number(null===e||void 0===e?void 0:e.expiry_date),new Date(Number(o)/1e6).toLocaleString())}),(0,N.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-white",children:(0,N.jsxs)("div",{className:"flex flex-col items-center justify-center gap-1",children:[c&&(null===c||void 0===c||null===(n=c.principal)||void 0===n?void 0:n.toString())==(null===e||void 0===e||null===(l=e.user)||void 0===l?void 0:l.toString())&&(0,N.jsx)("button",{onClick:()=>{y({offer:e,nft:r}),h(!0)},className:"flex  bg-red-500 p-1 rounded-lg",children:"Cancel"}),c&&(null===c||void 0===c||null===(i=c.principal)||void 0===i?void 0:i.toString())==s&&(0,N.jsx)("button",{onClick:()=>{y({offer:e,nft:r}),w(!0)},className:"flex bg-green-500 p-1 rounded-lg",children:"Accept"})]})})]},t)})):(0,N.jsx)("div",{className:"flex w-full justify-center items-center text-xs mt-3",children:" No offers available"})})]})]})};var k=r(2188);const O=e=>{let{collectionID:t,nftID:r,nftPrice:a,nftDetails:l}=e;const[i,c]=(0,n.useState)([]),{data:o,isLoading:d}=(0,s.I)({queryKey:["myTokens"]});return(0,n.useEffect)((()=>{(async()=>{try{console.log(" gg sd :",o);let e=null===o||void 0===o?void 0:o.slice(0,4),r=null===e||void 0===e?void 0:e.map(((e,r)=>(0,N.jsx)(k.A,{nft:e,collectionID:t},r)));console.log("price range :",e),c(r)}catch(e){console.log("error in getting more nfts :",e)}})()}),[l]),(0,N.jsxs)("div",{className:"flex flex-col w-full",children:[(0,N.jsx)("div",{className:"flex w-full items-center justify-center",children:"More NFTS from this collection"}),(0,N.jsx)("div",{className:"flex flex-col w-full",children:(0,N.jsx)("div",{className:"flex flex-row w-full",children:(0,N.jsx)("div",{className:"flex-grow w-full flex mt-6 justify-center items-center flex-wrap",children:i})})})]})};r(2126);var T=r(5772),S=r(6551),R=r(8063);const F={wrapper:"flex gap-3 mt-[80px] flex-col md:flex-row justify-center bg-[#121212] h-screen p-4 text-white",leftwrapper:"flex flex-col  items-center md:items-start  mb-4 md:mb-0",rightwrapper:"flex flex-col   h-full",nftImg:" rounded-md ml-3 w-auto cursor-pointer"},V=()=>{var e,t,r;const{colID:m,nftID:p}=(0,l.g)(),[h,v]=(0,n.useState)(null),[k,V]=(0,n.useState)(""),[C,A]=(0,n.useState)(!1),[I,q]=(0,n.useState)(!1),[D,B]=(0,n.useState)(!1),[E,P]=(0,n.useState)(""),U=(0,l.Zp)(),{user:z}=(0,g._d)(),{data:M}=(0,s.I)({queryKey:["marketplaceActor"]}),{data:L,isLoading:K}=(0,s.I)({queryKey:["myTokens"]}),{data:W}=(0,s.I)({queryKey:["bulkData"]}),$="ic"!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DFX_NETWORK?"https://ic0.app":"http://localhost:4943",G=new c.qB({host:$,retryTimes:10}),X=((0,x.M)(m,o.c,G),(0,x.M)(d.WC,u.c,G)),[J,Z]=(0,n.useState)(null),[H,Y]=(0,n.useState)(!1),[Q,ee]=(0,n.useState)(""),[te,re]=(0,n.useState)(""),{invalidateListings:se}=(0,b.A)(),ae=async(e,t)=>{ee(e),re(t),Y(!0),setTimeout((()=>Y(!1)),3e3)},ne=e=>P(Math.random());(0,n.useEffect)((()=>{(async()=>{try{var e,t;if(!m||!p)return;q(!0);let a=(0,i.T)(p,m);(0,x.M)(d.qY,o.c,G);const n=null===L||void 0===L?void 0:L.find((e=>e[0]==p));let l=await(null===X||void 0===X?void 0:X.get_nft_sale_history(a)),c=null===(e=(null===W||void 0===W?void 0:W.find((e=>e[0]==m)))[1])||void 0===e||null===(t=e.transactions)||void 0===t?void 0:t.filter((e=>(null===e||void 0===e?void 0:e.token)==a));if(l.data.length>0?Z([...c,...null===l||void 0===l?void 0:l.data[0]]):Z([...c]),(null===n||void 0===n?void 0:n.length)>0)if(n[1].inhouse_sale){let e=await(null===X||void 0===X?void 0:X.get_listed_nft_details(a));200===e.status&&"Ok"===e.status_text&&v(e.data[0])}else{var r,s;v({seller_principal:null===(r=n[1].seller)||void 0===r?void 0:r.toString(),nft_price:null===(s=n[1])||void 0===s?void 0:s.price,token_identifier:(0,i.T)(n[0],m)})}}catch(a){console.log("error in fetching details :",a)}q(!1)})()}),[m,p,E]);const{mutateAsync:le}=(0,a.n)({mutationFn:e=>ie(e),onSuccess:async()=>{se(),q(!1),U("../profile")}}),ie=async e=>{if(e.preventDefault(),h){q(!0);try{let e=await M.un_list_nft(h.token_identifier);console.log("unlisting res :",e),200==e.status&&"Ok"==e.status_text?ae("NFT unlisted successfully","success"):ae(e.error_text[0],"error")}catch(t){console.log("error in unlisting token :",t)}}},{mutateAsync:ce}=(0,a.n)({mutationFn:e=>oe(e),onSuccess:async()=>{se(),q(!1)}}),oe=async e=>{if(e.preventDefault(),console.log("new price : ",k),!k||0==k)return;B(!0);let t=await(null===M||void 0===M?void 0:M.update_nft_price(h.token_identifier,parseInt(1e8*k)));200==t.status&&"Ok"==t.status_text?ae("price updated successfully","success"):ae(t.error_text,"error"),console.log("update price results :",t),B(!1)};return(0,N.jsxs)("div",{className:"flex w-full min-h-screen gap-4 flex-col text-white mr-6 pr-6 md:px-20 mt-[100px]",children:[(0,N.jsxs)("div",{className:"flex w-full h-full flex-col md:flex-row gap-2 mx-4",children:[(0,N.jsxs)("div",{className:"flex flex-col gap-4 w-full md:w-1/2 h-full md:items-start  mb-4 md:mb-0",children:[(0,N.jsx)("div",{className:"rounded-lg p-1 w-full flex border border-gray-400 pt-3 flex-col",children:(0,N.jsx)("img",{src:`https://${m}.raw.icp0.io/?tokenid=${(0,i.T)(p,m)}&type=thumbnail`,alt:"",className:F.nftImg})}),(0,N.jsxs)("div",{className:"flex flex-col w-full items-start",children:[(0,N.jsx)("h1",{children:"Traits"}),(0,N.jsx)("span",{className:"text-sm",children:"Coming Soon ..."})]})]}),(0,N.jsx)("div",{className:"flex  justify flex-col w-full md:w-1/2 ",children:(0,N.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,N.jsxs)("h1",{className:"text-[30px] font-bold",children:[h&&"ICKitties"," # ",p]}),(0,N.jsxs)("span",{children:["Owned by ",null===h||void 0===h||null===(e=h.seller_principal)||void 0===e?void 0:e.toString()]}),(0,N.jsxs)("div",{className:"flex gap-1  text-sm",children:[(0,N.jsx)("span",{children:(0,N.jsx)(f.W7w,{size:25,color:"gray"})}),(0,N.jsx)("span",{children:"20 views"})]}),(0,N.jsxs)("div",{className:"flex flex-col  xs:px-3 md:px-0 gap-4 w-full",children:[(0,N.jsxs)("div",{className:"flex  flex-col w-full gap-1  bg-[#1B1B1B] border border-gray-400 p-2 rounded-lg",children:[(0,N.jsx)("h3",{children:"Current Price"}),(0,N.jsxs)("div",{className:"flex flex-row gap-1",children:[(0,N.jsx)("img",{src:R,height:"7px",width:"15px"}),(0,N.jsx)("span",{className:"flex text-lg",children:h&&(Number(null===h||void 0===h?void 0:h.nft_price)/1e8).toFixed(2)})]}),z&&z.principal.toString()==(null===h||void 0===h||null===(t=h.seller_principal)||void 0===t?void 0:t.toString())?(0,N.jsxs)("div",{className:"flex flex-row gap-4 justify-center items-center w-full",children:[(0,N.jsx)(T.A,{nft:null===h||void 0===h?void 0:h.token_identifier}),(0,N.jsx)(S.A,{nft:null===h||void 0===h?void 0:h.token_identifier,handleTrigger:ne})]}):(0,N.jsxs)("div",{className:"flex flex-row gap-4 w-full",children:[(0,N.jsx)(y,{nft_price:Number(null===h||void 0===h?void 0:h.nft_price),nftid:null===h||void 0===h?void 0:h.token_identifier}),(0,N.jsx)(_,{nft_price:Number(null===h||void 0===h?void 0:h.nft_price),nftid:null===h||void 0===h?void 0:h.token_identifier,handleTrigger:ne})]})]}),(0,N.jsx)(j,{history:J}),(0,N.jsx)(w,{offers:null===h||void 0===h?void 0:h.offers,nft:null===h||void 0===h?void 0:h.token_identifier,nftOwner:null===h||void 0===h||null===(r=h.seller_principal)||void 0===r?void 0:r.toString(),handleTrigger:ne})]})]})})]}),h&&(0,N.jsx)(O,{nftDetails:h,collectionID:m,nftID:p,nftPrice:Number(null===h||void 0===h?void 0:h.nft_price)/1e8})]})}},6551:(e,t,r)=>{r.d(t,{A:()=>f});var s=r(7097),a=r(5043),n=r(8973),l=r(8247),i=r(2013),c=r(1699),o=r(1935),d=r(39),u=r(4230),x=r(579);const f=e=>{let{nft:t,handleTrigger:r}=e;const[f,m]=(0,a.useState)(!1),[p,g]=(0,a.useState)(""),[h,v]=(0,a.useState)(!1),{invalidateListings:N}=(0,i.A)(),[_,b]=(0,a.useState)(!1),y=(0,d.fJ)(),{user:j}=(0,d._d)(),[w,k]=(0,a.useState)(!1),[O,T]=(0,a.useState)(""),[S,R]=(0,a.useState)(""),F=async(e,t)=>{T(e),R(t),k(!0),setTimeout((()=>k(!1)),3e3)},{mutateAsync:V}=(0,s.n)({mutationFn:e=>C(e),onSuccess:async()=>{N()}}),C=async e=>{e.preventDefault();let s=(0,c.M)(o.WC,u.c,y);if(console.log("new price : ",p,t),!s)return void F("login first","error");if(!p||0==p||!t)return;b(!0),v(!0);let a=await(null===s||void 0===s?void 0:s.update_nft_price(t,parseInt(1e8*p)));200==(null===a||void 0===a?void 0:a.status)&&"Ok"==(null===a||void 0===a?void 0:a.status_text)?F("price updated successfully","success"):F(null===a||void 0===a?void 0:a.error_text,"error"),r(),b(!1),v(!1)};return(0,x.jsxs)("div",{className:"flex flex-col gap-1 w-1/2",children:[w&&(0,x.jsx)("div",{className:"absolute text-xs top-5 z-50  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===S?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,x.jsx)("div",{className:"modal-message",children:(0,x.jsx)("p",{children:O})})}),(0,x.jsx)("button",{className:"flex bg-[#6fa0d1] w-full rounded-lg mt-4 font-bold text-white justify-center items-center p-2",onClick:()=>m(!0),children:"Update"}),f&&(0,x.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:(0,x.jsxs)("div",{className:"bg-[#252525] rounded-lg shadow-lg p-6 w-96",children:[(0,x.jsxs)("div",{className:"flex justify-between ",children:[(0,x.jsx)("h2",{className:" mb-4",children:"Update NFT price"}),(0,x.jsx)(n.PXF,{className:"cursor-pointer",onClick:()=>m(!1)})]}),(0,x.jsxs)("form",{onSubmit:V,children:[(0,x.jsx)("input",{type:"number",id:"price",value:p,placeholder:"enter new nft price",onChange:e=>g(e.target.value),className:" border border-white text-black rounded p-1 w-full mb-4",required:!0}),(0,x.jsx)("div",{className:"flex justify-end",children:h?(0,x.jsx)(l.A,{color:"white",size:20}):(0,x.jsx)("button",{type:"submit",className:"px-4 py-2 bg-white text-black rounded",children:"update"})})]})]})})]})}},5772:(e,t,r)=>{r.d(t,{A:()=>m});var s=r(7097),a=r(5043),n=r(8973),l=r(8247),i=r(2013),c=r(39),o=r(1935),d=r(4230),u=r(1699),x=r(3216),f=r(579);const m=e=>{let{nft:t,handleTrigger:r}=e;const[m,p]=(0,a.useState)(!1),[g,h]=(0,a.useState)(!1),[v,N]=(0,a.useState)(!1),[_,b]=(0,a.useState)(""),[y,j]=(0,a.useState)(""),{invalidateListings:w,invalidateUserNfts:k}=(0,i.A)(),O=(0,c.fJ)(),T=(0,x.Zp)(),S=async(e,t)=>{b(e),j(t),N(!0),setTimeout((()=>N(!1)),3e3)},{mutateAsync:R}=(0,s.n)({mutationFn:()=>F(),onSuccess:async()=>{w(),k(),h(!1)}}),F=async()=>{let e=(0,u.M)(o.WC,d.c,O);if(t&&e){h(!0);try{console.log("unlist :",t);let s=await(null===e||void 0===e?void 0:e.un_list_nft(t));200==(null===s||void 0===s?void 0:s.status)&&"Ok"==(null===s||void 0===s?void 0:s.status_text)?S("NFT unlisted successfully","success"):S(null===s||void 0===s?void 0:s.error_text,"error"),r(),T("/profile"),console.log("unlisting res :",s)}catch(s){console.log("error in unlisting token :",s)}}};return(0,f.jsxs)("div",{className:"flex flex-col gap-1 w-1/2",children:[(0,f.jsx)("div",{className:"flex flex-row gap-4",children:(0,f.jsx)("button",{className:"flex bg-[#2c2d2e] rounded-lg w-full mt-4 font-bold text-white justify-center items-center p-2 cursor-pointer",onClick:()=>p(!0),children:"Unlist"})}),m&&(0,f.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:[v&&(0,f.jsx)("div",{className:"absolute top-10 text-xs z-50  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===y?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,f.jsx)("div",{className:"modal-message",children:(0,f.jsx)("p",{children:_})})}),(0,f.jsxs)("div",{className:"bg-[#252525] rounded-lg shadow-lg p-6 w-96",children:[(0,f.jsxs)("div",{className:"flex justify-between ",children:[(0,f.jsx)("h2",{className:" mb-4",children:"Unlist NFT"}),(0,f.jsx)(n.PXF,{className:"cursor-pointer",onClick:()=>p(!1)})]}),(0,f.jsx)("span",{children:"Remove NFT from the marketplace?"}),(0,f.jsx)("div",{className:"flex justify-end mt-3",children:g?(0,f.jsx)(l.A,{color:"white",size:20}):(0,f.jsx)("button",{onClick:R,className:"px-4 py-2 bg-white text-black rounded",children:"Unlist"})})]})]})]})}},2188:(e,t,r)=>{r.d(t,{A:()=>c});r(5043);var s=r(8657),a=r(1289),n=r(3216),l=r(8063),i=r(579);const c=e=>{var t,r,c;let{collectionID:o,nft:d}=e;const u=(0,n.Zp)();return(0,i.jsxs)("div",{className:" rounded bg-[#202020] w-[250px] m-2 rounded-b-lg",children:[(0,i.jsx)("img",{onClick:()=>u("../marketplace/"+o+"/"+d[0]),src:`https://${o}.raw.icp0.io/?tokenid=${(0,a.T)(d[0],o)}&type=thumbnail`,alt:"NFT",className:"w-[100%] ml-[2.5px] cursor-pointer  object-cover rounded mb-2"}),(0,i.jsxs)("div",{className:"flex w-full px-2 justify-between",children:[(0,i.jsxs)("p",{children:["#",d[0]]}),null!==(t=d[1])&&void 0!==t&&t.price?(0,i.jsxs)("div",{className:"flex gap-1",children:[(0,i.jsx)("img",{src:l,height:"7px",width:"15px",alt:"logo"}),(0,i.jsx)("span",{children:null===(r=Number(null===(c=d[1])||void 0===c?void 0:c.price)/1e8)||void 0===r?void 0:r.toFixed(2)})]}):"unlisted"]}),(0,i.jsx)("div",{className:`opacity-0 ${void 0!=d[1].price&&"hover:opacity-100"} transition-opacity duration-300`,children:(0,i.jsx)(s.A,{nftid:d[0],nft_price:Number(d[1].nft_price),userP:d[1].seller_principal})})]},d.id)}},8063:(e,t,r)=>{e.exports=r.p+"static/media/icplogo.71d22b69911f6dedf410.png"}}]);
//# sourceMappingURL=670.2f2231e5.chunk.js.map