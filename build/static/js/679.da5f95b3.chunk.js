"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[679],{1289:(e,l,t)=>{t.d(l,{T:()=>i});var s=t(2198);function i(e,l){let t=new Uint8Array([10,116,105,100]);const i=s.Principal.fromText(l).toUint8Array();t=new Uint8Array([...t,...i]);let r=e;for(let s=3;s>=0;s--){const e=Math.pow(2,8*s),l=Math.floor(r/e);t=new Uint8Array([...t,l]),r-=l*e}return s.Principal.fromUint8Array(t).toText()}},8657:(e,l,t)=>{t.d(l,{A:()=>x});var s=t(3747),i=t(7097),r=t(5043),a=t(1935),n=t(2198),o=t(710),c=t(2013),d=t(3216),u=t(579);const x=e=>{let{nftid:l,nft_price:t,userP:x}=e;const[h,m]=(0,r.useState)(!1),[p,f]=(0,r.useState)(!1),[v,g]=(0,r.useState)(""),[j,b]=(0,r.useState)(""),{invalidateListings:y,invalidateUserNfts:N,invalidateUserBalance:w}=(0,c.A)(),C=async(e,l)=>{g(e),b(l),f(!0),setTimeout((()=>f(!1)),3e3)},{data:P}=(0,s.I)({queryKey:["userPrincipal"]}),{data:k}=(0,s.I)({queryKey:["userIcpBalance"]}),{data:S}=(0,s.I)({queryKey:["allListings"]}),{data:_}=(0,s.I)({queryKey:["userNFTS"]}),{data:T}=(0,s.I)({queryKey:["nftActor"]}),{data:L}=(0,s.I)({queryKey:["marketplaceActor"]}),{data:M}=(0,s.I)({queryKey:["IcpActor"]}),I=(0,d.Zp)(),{mutateAsync:A}=(0,i.n)({mutationFn:()=>F(),onSuccess:async()=>{y(),N(),w(),m(!1)}}),F=async()=>{try{if(!L)return alert("Log in first to purchase this NFT"),void C("Log in first to purchase this NFT","error");m(!0);let e=await M.icrc2_approve({fee:[],memo:[],from_subaccount:[],created_at_time:[],amount:Number(t)+2e4,expected_allowance:[],expires_at:[],spender:{owner:n.Principal.fromText(a.WC),subaccount:[]}});console.log("approve results :",e);let s=await L.buy_nft(l);200==s.status&&"Ok"==s.status_text?C("NFT purchase successful","success"):C(s.error_text,"error"),console.log("buy results :",s)}catch(e){console.log("error in buying nft :",e)}I("/profile")};return(0,u.jsxs)(u.Fragment,{children:[p&&(0,u.jsx)("div",{className:"absolute top-10 z-50 text-xs  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===j?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,u.jsx)("div",{className:"modal-message",children:(0,u.jsx)("p",{children:v})})}),(0,u.jsx)("button",{onClick:()=>A(),className:"flex w-full bg-[#2E8DEE] rounded-b-lg mt-4 font-bold text-white justify-center items-center p-2",children:h?(0,u.jsx)(o.A,{size:20,color:"white"}):"Buy"})]})}},2156:(e,l,t)=>{t.d(l,{A:()=>o});t(5043);var s=t(8657),i=t(1289),r=t(3216);const a=t.p+"static/media/icplogo.71d22b69911f6dedf410.png";var n=t(579);const o=e=>{var l,t,o;let{collectionID:c,nft:d}=e;const u=(0,r.Zp)();return(0,n.jsxs)("div",{className:" rounded bg-[#202020] w-[250px] m-2 rounded-b-lg",children:[(0,n.jsx)("img",{onClick:()=>u("../marketplace/"+c+"/"+d[0]),src:`https://${c}.raw.icp0.io/?tokenid=${(0,i.T)(d[0],c)}&type=thumbnail`,alt:"NFT",className:"w-[100%] ml-[2.5px] cursor-pointer  object-cover rounded mb-2"}),(0,n.jsxs)("div",{className:"flex w-full px-2 justify-between",children:[(0,n.jsxs)("p",{children:["#",d[0]]}),null!==(l=d[1])&&void 0!==l&&l.price?(0,n.jsxs)("div",{className:"flex gap-1",children:[(0,n.jsx)("img",{src:a,height:"7px",width:"15px",alt:"logo"}),(0,n.jsx)("span",{children:null===(t=Number(null===(o=d[1])||void 0===o?void 0:o.price)/1e8)||void 0===t?void 0:t.toFixed(2)})]}):"unlisted"]}),(0,n.jsx)("div",{className:`opacity-0 ${void 0!=d[1].price&&"hover:opacity-100"} transition-opacity duration-300`,children:(0,n.jsx)(s.A,{nftid:d[0],nft_price:Number(d[1].nft_price),userP:d[1].seller_principal})})]},d.id)}},961:(e,l,t)=>{t.r(l),t.d(l,{default:()=>N});var s=t(826),i=t(5043),r=t(3216),a=t(1935),n=t(1699),o=t(710),c=t(579);const d=e=>{let{collectionData:l,isLoading:t}=e;const[s,r]=(0,i.useState)(!1);return console.log("dddd :",l),(0,c.jsxs)("div",{className:"flex flex-col mt-[80px]",children:[l&&!t?(0,c.jsx)("div",{className:"relative rounded w-full object-cover mx-auto",children:(0,c.jsxs)("div",{className:"overflow-hidden h-[200px] w-full",children:[(0,c.jsx)("img",{src:l.imgUrl,alt:l.name,className:"w-full rounded-lg h-full object-cover"}),(0,c.jsx)("div",{className:"absolute bottom-0 left-0 right-0 text-white p-2",children:(0,c.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-end",children:[(0,c.jsx)("h2",{className:"text-xl font-bold",children:l.name}),(0,c.jsxs)("div",{className:"flex  flex-row justify-between gap-4 mt-1",children:[(0,c.jsxs)("div",{className:"flex flex-col",children:[(0,c.jsx)("span",{children:"Volume"}),(0,c.jsxs)("span",{children:[(Number(l.volume)/1e11).toFixed(2),"k"]})]}),(0,c.jsxs)("div",{className:"flex flex-col",children:[(0,c.jsx)("span",{children:"Listings"}),(0,c.jsx)("span",{children:Number(l.totalListed)})]}),(0,c.jsxs)("div",{className:"flex flex-col",children:[(0,c.jsx)("span",{children:"Floor Price"}),(0,c.jsx)("span",{children:(Number(l.floorPrice)/1e8).toFixed(2)})]})]})]})})]})},null===l||void 0===l?void 0:l.canisterId):(0,c.jsx)("div",{className:"flex flex-col mt-[80px] justify-center items-center",children:(0,c.jsx)(o.A,{size:25,color:"white"})}),l&&!t&&(0,c.jsxs)("div",{className:"mx-4 p-4 flex flex-col justify-center items-center",children:[(0,c.jsx)("div",{className:"text-white text-center",children:s?null===l||void 0===l?void 0:l.description:`${null===l||void 0===l?void 0:l.description.slice(0,150)}...`}),(0,c.jsx)("button",{onClick:()=>{r(!s)},className:"text-white text-md font-bold flex justify-center items-center hover:underline mt-2",children:s?"See Less":"See More"})]})]})};t(1289),t(8657);var u=t(2156);const x=e=>{let{results:l,isSidebarOpen:t,isLoading:s,minPrice:i,maxPrice:r,handleMinPriceChange:a,handleMaxPriceChange:n}=e;return(0,c.jsxs)("div",{className:"flex  w-full  text-white gap-3 border-gray-400 p-2",children:[t&&(0,c.jsx)("div",{className:"hidden md:block border border-gray-600 p-4 w-1/4",children:(0,c.jsxs)("div",{className:"flex txt-black flex-col mt-4",children:[(0,c.jsx)("span",{children:"Price"}),(0,c.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,c.jsx)("input",{type:"text",placeholder:"Min",value:i,onChange:a,className:"p-1 rounded text-black",required:!0}),(0,c.jsx)("input",{type:"text",placeholder:"Max",value:r,onChange:n,className:"p-1 rounded text-black",required:!0})]}),(0,c.jsx)("div",{className:"flex flex-col mt-4",children:(0,c.jsx)("span",{children:"Traits"})})]})}),(0,c.jsx)("div",{className:"flex flex-col w-full",children:(0,c.jsx)("div",{className:"flex flex-row w-full",children:(0,c.jsx)("div",{className:"flex-grow w-full flex  justify-center items-center flex-wrap",children:s?(0,c.jsx)(o.A,{size:25,color:"white"}):l})})})]})};var h=t(5394);const m=e=>{let{onClickHandler:l,value:t,title:s}=e;return(0,c.jsx)("button",{onClick:l,value:t,className:"btns",children:s})};var p=t(423);const f=e=>{let{currentPage:l,nextPage:t,pages:s,prevPage:i,searchQuery:r,sortPrice:a,isModalOpen:n,toggleSidebar:o,closeModal:d,handlelistedChange:u,handleSortPriceChange:x,handleSearchChange:f,maxPrice:v,minPrice:g,handleMaxPriceChange:j,handleMinPriceChange:b}=e;return(0,c.jsxs)("div",{className:"flex flex-col w-full gap-4 p-2",children:[(0,c.jsxs)("div",{className:"flex mt-[05px] cursor-pointer border-b-[1px] pb-2 border-white flex-row justify-between items-center w-full",children:[(0,c.jsx)(h.n6t,{size:35,color:"white",onClick:o}),(0,c.jsxs)("div",{className:"hidden md:block relative ",children:[(0,c.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:(0,c.jsx)(p.uG9,{color:"gray",size:25})}),(0,c.jsx)("input",{type:"text",className:"hidden md:block bg-transparent border outline-none border-gray-300 text-white rounded-lg w-full pl-10 p-2.5",placeholder:"Search by name or trait",onChange:f,value:r})]}),(0,c.jsx)("div",{className:"hidden md:flex md:flex-row gap-2",children:(0,c.jsxs)("select",{value:a,onChange:x,className:" block bg-transparent  text-white  w-full p-3 border rounded-lg",children:[(0,c.jsx)("option",{value:"lowtohigh",className:"bg-red-400",children:"Price Low to High"}),(0,c.jsx)("option",{value:"hightolow",children:"Price High to Low"})]})})]}),(0,c.jsx)("div",{className:"hidden md:flex-row md:block justify-between items-center cursor-pointer",children:(0,c.jsxs)("div",{className:"flex flex-row justify-between items-center ",children:[(0,c.jsxs)("div",{className:"flex mt-4",children:[(0,c.jsx)(m,{onClickHandler:u,value:"all",title:"All"}),(0,c.jsx)(m,{onClickHandler:u,value:"listed",title:"Listed"}),(0,c.jsx)(m,{onClickHandler:u,value:"hasoffers",title:"Has Offers"})]}),(0,c.jsxs)("div",{className:"flex gap-4 items-center justify-center mt-4",children:[(0,c.jsx)("button",{onClick:i,disabled:0===l,className:"px-4 py-1 bg-transparent border text-white rounded "+(0===l?"opacity-50 cursor-not-allowed":""),children:"Previous"}),(0,c.jsx)("button",{onClick:t,disabled:l>=s-1,className:"px-4 py-1 bg-transparent border text-white rounded "+(l>=s-1?"opacity-50 cursor-not-allowed":""),children:"Next"})]})]})}),n&&(0,c.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-70 flex justify-center items-center z-50",children:(0,c.jsxs)("div",{className:"bg-[#202020] p-4 rounded-lg w-[90%] md:w-[400px]",children:[(0,c.jsxs)("div",{className:"flex w-full justify-between items-center",children:[(0,c.jsx)("h2",{className:"text-lg font-bold text-white mb-2",children:"Filter"}),(0,c.jsx)("button",{onClick:d,className:"text-red-400 font-bold float-right cursor-pointer text-lg",children:"X"})]}),(0,c.jsx)("input",{type:"text",placeholder:"Search by name or trait...",value:r,onChange:f,className:"p-1 rounded outline-none bg-gray-300 border-none mt-6 w-full"}),(0,c.jsx)("div",{className:" md:block  mt-6 justify-between items-center cursor-pointer",children:(0,c.jsxs)("div",{children:[(0,c.jsx)(m,{onClickHandler:u,value:"all",title:"All"}),(0,c.jsx)(m,{onClickHandler:u,value:"listed",title:"Listed"}),(0,c.jsx)(m,{onClickHandler:u,value:"hasoffers",title:"Has Offers"})]})}),(0,c.jsxs)("select",{value:a,onChange:x,className:"mt-4 block bg-gray-300 text-black w-full p-2 border rounded",children:[(0,c.jsx)("option",{value:"lowtohigh",children:"Price Low to High"}),(0,c.jsx)("option",{value:"hightolow",children:"Price High to Low"})]}),(0,c.jsxs)("div",{className:"flex flex-col mt-4",children:[(0,c.jsx)("span",{className:"text-white",children:"Price"}),(0,c.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,c.jsx)("input",{type:"text",placeholder:"Min",value:g,onChange:b,className:"p-1 rounded border-none bg-gray-300 outline-none text-black",required:!0}),(0,c.jsx)("input",{type:"text",placeholder:"Max",value:v,onChange:j,className:"p-1 rounded bg-gray-300 border-none outline-none text-black",required:!0})]}),(0,c.jsx)("div",{className:"flex flex-col mt-4",children:(0,c.jsx)("span",{className:"text-white",children:"Traits"})})]})]})})]})};var v=t(4230),g=t(3248),j=t(3747);const b="ic"!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DFX_NETWORK?"https://ic0.app":"http://localhost:4943",y=new s.qB({host:b,retryTimes:10}),N=()=>{const{collectionID:e}=(0,r.g)(),[l,t]=(0,i.useState)(null),[s,o]=(0,i.useState)(""),[h,m]=(0,i.useState)("lowtohigh"),[p,b]=(0,i.useState)("listed"),[N,w]=(0,i.useState)(""),[C,P]=(0,i.useState)(""),[k,S]=(0,i.useState)(!0),[_,T]=(0,i.useState)(0),[L,M]=(0,i.useState)([]),[I,A]=(0,i.useState)([]),[F,O]=(0,i.useState)(!0),[q,H]=(0,i.useState)(!1),E=(0,g.jE)(),{data:K}=(0,j.I)({queryKey:["bulkData"]}),{data:D,isLoading:U}=(0,j.I)({queryKey:["myTokens"]}),{data:z}=(0,j.I)({queryKey:[e]}),{data:W,isLoading:B}=(0,j.I)({queryKey:["collectionDetails"]});(0,i.useEffect)((()=>{(async()=>{S(!0),console.log("xxxxxxxx :",W,K);try{var l,s,i,r;const o=(0,n.M)(a.WC,v.c,y),c=a.Oq.find((l=>l.canisterId===e)),d=await(null===o||void 0===o?void 0:o.get_all_listed_nfts()),u=(null===d||void 0===d||null===(l=d.data[0])||void 0===l?void 0:l.filter((l=>l[1].nft_canister==e)))||[],x=null===u||void 0===u?void 0:u.map((e=>[e[1].nft_id,{locked:[],seller:e[1].seller_principal,price:e[1].nft_price,inhouse_sale:!0}]));let h=null===K||void 0===K?void 0:K.find((l=>l[0]==e)),m=null===W||void 0===W?void 0:W.find((l=>l.canisterId==e));console.log("dede :",h[1].listings);const p=[...null===(s=h[1])||void 0===s?void 0:s.listings,...x];M(p),console.log("filte eeee :",h[1]),console.log("col details :",m);const f=Object.fromEntries(p.map((e=>[e[0],e]))),g=null===(i=h[1])||void 0===i||null===(r=i.allNftTokens)||void 0===r?void 0:r.map((e=>f[e[0]]?f[e[0]]:e));console.log("all ttt :",g),A(g),E.setQueryData(["myTokens"],g),c&&t({imgUrl:null===m||void 0===m?void 0:m.imgUrl,canisterId:null===m||void 0===m?void 0:m.canisterId,name:null===m||void 0===m?void 0:m.name,description:null===m||void 0===m?void 0:m.description,volume:null===m||void 0===m?void 0:m.volume,floorPrice:null===m||void 0===m?void 0:m.floorprice,totalListed:null===m||void 0===m?void 0:m.totalListed})}catch(o){console.error("Error loading NFT data:",o)}finally{S(!1)}})()}),[e]);const R=e=>w(e.target.value),$=e=>P(e.target.value);console.log(p,N);const Q=(0,i.useMemo)((()=>{let l=L;return s&&(l=l.filter((e=>{var l;return null===(l=e[0])||void 0===l?void 0:l.toString().toLowerCase().includes(s.toLowerCase())}))),h&&l.sort(((e,l)=>"lowtohigh"===h?Number(e[1].price)-Number(l[1].price):Number(l[1].price)-Number(e[1].price))),"listed"==p&&(l=l.filter((e=>{var l;return null===(l=e[1])||void 0===l?void 0:l.hasOwnProperty("price")}))),N&&(l=l.filter((e=>{var l;return Number(null===(l=e[1])||void 0===l?void 0:l.price)/1e8>=parseFloat(N)}))),C&&(l=l.filter((e=>{var l;return Number(null===(l=e[1])||void 0===l?void 0:l.price)/1e8<=parseFloat(C)}))),l.slice(50*_,50*(_+1)).map(((l,t)=>(0,c.jsx)(u.A,{nft:l,collectionID:e},t)))}),[L,s,h,p,N,C,_]),V=Math.ceil(I.length/50);return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"flex flex-col mx-4 md:mx-20 mt-50",children:[(0,c.jsx)(d,{collectionData:l,isLoading:U}),(0,c.jsx)(f,{prevPage:()=>{_>0&&T((e=>e-1))},nextPage:()=>{_<V-1&&T((e=>e+1))},currentPage:_,sortPrice:h,pages:V,searchQuery:s,isModalOpen:q,closeModal:()=>H(!1),maxPrice:C,minPrice:N,handleMaxPriceChange:$,handleMinPriceChange:R,toggleSidebar:()=>{window.innerWidth<768?H(!0):O((e=>!e))},handleSearchChange:e=>o(e.target.value),handleSortPriceChange:e=>m(e.target.value),handlelistedChange:e=>b((l=>e.target.value))}),(0,c.jsx)(x,{results:Q,isLoading:U,maxPrice:C,minPrice:N,isSidebarOpen:F,isModalOpen:q,handleMaxPriceChange:$,handleMinPriceChange:R,closeModal:()=>H(!1)})]})})}}}]);
//# sourceMappingURL=679.da5f95b3.chunk.js.map