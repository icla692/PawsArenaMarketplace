"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[284],{1289:(e,t,s)=>{s.d(t,{T:()=>a});var r=s(2198);function a(e,t){let s=new Uint8Array([10,116,105,100]);const a=r.Principal.fromText(t).toUint8Array();s=new Uint8Array([...s,...a]);let n=e;for(let r=3;r>=0;r--){const e=Math.pow(2,8*r),t=Math.floor(n/e);s=new Uint8Array([...s,t]),n-=t*e}return r.Principal.fromUint8Array(s).toText()}},9284:(e,t,s)=>{s.r(t),s.d(t,{default:()=>k});var r=s(5043),a=s(3747),n=(s(1614),s(6246),s(3825)),i=s(2126),l=s(2198),c=s(1289),o=s(5123),d=s(7097),u=s(8973),x=s(710),m=s(1935),f=s(2013),p=s(579);const b=e=>{let{nft:t}=e;const[s,n]=(0,r.useState)(!1),[i,o]=(0,r.useState)(0),[b,h]=(0,r.useState)(!1),{invalidateListings:g}=(0,f.A)(),[j,y]=(0,r.useState)(!1),[v,N]=(0,r.useState)(""),[w,k]=(0,r.useState)(""),C=async(e,t)=>{N(e),k(t),y(!0),setTimeout((()=>y(!1)),3e3)},{data:S}=(0,a.I)({queryKey:["userPrincipal"]}),{data:A}=(0,a.I)({queryKey:["nftActor"]}),{data:T}=(0,a.I)({queryKey:["marketplaceActor"]}),{mutateAsync:I}=(0,d.n)({mutationFn:e=>P(e),onSuccess:async()=>{g(),h(!1)}}),P=async e=>{if(e.preventDefault(),T&&S&&A)if(0!=i){h(!0);try{let e=await(null===T||void 0===T?void 0:T.init_list_nft(l.Principal.fromText(S),t.nftid,{Kitties:null},parseInt(1e8*i)));console.log("init res:",e);let s=(0,c.T)(t.nftid,t.canister_id),r=await A.transfer({amount:parseInt(1),from:{principal:l.Principal.fromText(S)},memo:[],notify:!1,subaccount:[],to:{principal:l.Principal.fromText(m.WC)},token:s});console.log("transfer result:",r);let a=await T.complete_listing(l.Principal.fromText(S),t.nftid,{Kitties:null});console.log("final listing:",a),200==a.status&&"Ok"==a.status_text?C("NFT listed successfully","success"):C(a.error_text,"error")}catch(s){console.log("Error in listing NFT:",s)}}else alert("price is zero")};return(0,p.jsxs)("div",{className:"relative flex-row gap-1 flex w-full bg-[#2E8DEE] font-bold text-white justify-center items-center p-2 ",children:[(0,p.jsx)("button",{onClick:()=>n(!0),children:"List"}),s&&(0,p.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:[j&&(0,p.jsx)("div",{className:"absolute top-10 text-xs z-50  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===w?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,p.jsx)("div",{className:"modal-message",children:(0,p.jsx)("p",{children:v})})}),(0,p.jsxs)("div",{className:"bg-[#252525] rounded-lg shadow-lg p-6 w-96",children:[(0,p.jsxs)("div",{className:"flex justify-between ",children:[(0,p.jsx)("h2",{className:"text-xl font-bold mb-4",children:"List NFT"}),(0,p.jsx)(u.PXF,{className:"cursor-pointer",onClick:()=>n(!1)})]}),(0,p.jsxs)("form",{onSubmit:I,children:[(0,p.jsx)("label",{className:"block mb-2",htmlFor:"price",children:"Enter listing price"}),(0,p.jsx)("input",{type:"number",id:"price",value:i,onChange:e=>o(e.target.value),className:" border border-white text-black rounded p-1 w-full mb-4",required:!0}),(0,p.jsx)("div",{className:"flex justify-end",children:b?(0,p.jsx)(x.A,{color:"white",size:20}):(0,p.jsx)("button",{type:"submit",className:"px-4 py-2 bg-white text-black rounded",children:"Confirm listing"})})]})]})]})]})};var h=s(3216);const g=e=>{let{nft:t}=e;const[s,n]=(0,r.useState)(!1),[i,o]=(0,r.useState)(!1),[m,b]=(0,r.useState)(""),[h,g]=(0,r.useState)(!1),{invalidateListings:j}=(0,f.A)(),[y,v]=(0,r.useState)(!1),[N,w]=(0,r.useState)(""),[k,C]=(0,r.useState)(""),S=async(e,t)=>{w(e),C(t),v(!0),setTimeout((()=>v(!1)),3e3)},{mutateAsync:A}=(0,d.n)({mutationFn:e=>T(e),onSuccess:async()=>{j(),g(!1)}}),T=async e=>{e.preventDefault(),g(!0),console.log("nft :",t),P&&t||S("please login first","success");let s=(0,c.T)(Number(t.nftid),t.canister_id),r=await P.transfer({amount:parseInt(1),from:{principal:l.Principal.fromText(I)},memo:[],notify:!1,subaccount:[],to:{address:m},token:s});r.ok?S("NFT transfer successful","success"):S(r.err,"error"),console.log("transfer success",r)},{data:I}=(0,a.I)({queryKey:["userPrincipal"]}),{data:P}=(0,a.I)({queryKey:["nftActor"]}),{data:_}=(0,a.I)({queryKey:["marketplaceActor"]});return(0,p.jsxs)("div",{className:"relative flex-row gap-1 flex w-full bg-[#2E8DEE] font-bold text-white justify-center items-center p-2 ",children:[(0,p.jsx)("button",{onClick:()=>n(!0),children:"Transfer"}),s&&(0,p.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:[y&&(0,p.jsx)("div",{className:"absolute top-10 text-xs z-50  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===k?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,p.jsx)("div",{className:"modal-message",children:(0,p.jsx)("p",{children:N})})}),(0,p.jsxs)("div",{className:"bg-[#252525] rounded-lg shadow-lg p-6 w-96",children:[(0,p.jsxs)("div",{className:"flex justify-between ",children:[(0,p.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Transfer NFT"}),(0,p.jsx)(u.PXF,{className:"cursor-pointer",onClick:()=>n(!1)})]}),(0,p.jsxs)("form",{onSubmit:A,children:[(0,p.jsx)("input",{type:"text",id:"recipient",placeholder:"enter recipient account",value:m,onChange:e=>b(e.target.value),className:" border border-white text-black rounded p-1 w-full mb-4",required:!0}),(0,p.jsx)("div",{className:"flex justify-end",children:h?(0,p.jsx)(x.A,{color:"white",size:20}):(0,p.jsx)("button",{type:"submit",className:"px-4 py-2 bg-white text-black rounded",children:"Transfer"})})]})]})]})]})},j=e=>{let{recipient:t,amount:s,buttonLoading:r,onPreview:a,onRecipientChange:n,onAmountChange:i,onClose:l}=e;return(0,p.jsxs)("div",{className:"bg-[#252525] rounded-lg text-sm shadow-lg p-6 w-96",children:[(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("h2",{className:"mb-4",children:"Withdraw ICP"}),(0,p.jsx)(u.PXF,{className:"cursor-pointer",onClick:l})]}),(0,p.jsxs)("form",{onSubmit:a,children:[(0,p.jsx)("input",{type:"text",id:"recipient",value:t,placeholder:"Enter principal",onChange:e=>n(e.target.value),className:"border border-white text-black rounded p-1 w-full mb-4",required:!0}),(0,p.jsx)("input",{type:"number",id:"amount",value:s,placeholder:"Enter amount",onChange:e=>i(e.target.value),className:"border border-white text-black rounded p-1 w-full mb-4",required:!0}),(0,p.jsx)("div",{className:"flex justify-end",children:r?(0,p.jsx)(x.A,{color:"white",size:20}):(0,p.jsx)("button",{type:"submit",className:"px-4 py-2 bg-white text-black rounded",children:"Preview"})})]})]})},y=e=>{let{recipient:t,amount:s,buttonLoading:r,onWithdraw:a,onClose:n}=e;return(0,p.jsxs)("div",{className:"bg-[#252525] text-sm rounded-lg shadow-lg p-6 w-96",children:[(0,p.jsxs)("div",{className:"flex justify-between",children:[(0,p.jsx)("h2",{className:"text-xl border-b w-full mb-4",children:"Withdraw Preview"}),(0,p.jsx)(u.PXF,{className:"cursor-pointer",onClick:n})]}),(0,p.jsxs)("div",{className:"flex text-sm flex-col gap-1 w-full",children:[(0,p.jsx)(v,{label:"Destination:",value:(i=t,`${i.slice(0,15)}...${i.slice(-10)}`)}),(0,p.jsx)(v,{label:"Amount:",value:`${s} ICP`}),(0,p.jsx)(v,{label:"Fee:",value:"0.0001 ICP"})]}),(0,p.jsx)("div",{className:"flex mt-3 justify-end",children:r?(0,p.jsx)(x.A,{color:"white",size:20}):(0,p.jsx)("button",{onClick:a,className:"px-4 py-2 bg-white text-black rounded",children:"Send"})})]});var i},v=e=>{let{label:t,value:s}=e;return(0,p.jsxs)("div",{className:"flex flex-col",children:[(0,p.jsx)("span",{children:t}),(0,p.jsx)("span",{className:"flex text-gray-400",children:s})]})},N=()=>{const[e,t]=(0,r.useState)(!1),[s,n]=(0,r.useState)(!1),[i,c]=(0,r.useState)(""),[o,u]=(0,r.useState)(0),[x,m]=(0,r.useState)(!1),[b,h]=(0,r.useState)(!1),[g,v]=(0,r.useState)(""),[N,w]=(0,r.useState)(""),{invalidateListings:k,invalidateUserNfts:C,invalidateUserBalance:S}=(0,f.A)(),{data:A}=(0,a.I)({queryKey:["userIcpBalance"]}),{data:T}=(0,a.I)({queryKey:["IcpActor"]}),{mutateAsync:I}=(0,d.n)({mutationFn:e=>P(e),onSuccess:async()=>{k(),C(),S(),t(!1)}}),P=async e=>{if(e.preventDefault(),t(!0),T){try{const e=await T.icrc1_transfer({to:{owner:l.Principal.fromText(i),subaccount:[]},fee:[],memo:[],from_subaccount:[],created_at_time:[],amount:1e8*Number(o)});console.log("dddd2",e)}catch(r){console.error("Error in sending ICP:",r),s="error",v("An error occurred during the transfer"),w(s),h(!0),setTimeout((()=>h(!1)),3e3)}var s;t(!1)}};return(0,p.jsxs)("div",{className:"relative flex flex-row gap-1 text-white justify-center items-center p-2",children:[(0,p.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,p.jsx)("button",{className:"px-4 py-2 bg-white text-black rounded",onClick:()=>n(!0),children:"Withdraw"}),(0,p.jsxs)("span",{children:[A&&A," ICP"]})]}),s&&(0,p.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:[b&&(0,p.jsx)("div",{className:`absolute text-xs top-10 z-50 left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out ${"success"===N?"bg-green-100 text-green-800 border border-green-300":"bg-red-100 text-red-800 border border-red-300"} rounded-lg p-1`,children:(0,p.jsx)("p",{children:g})}),x?(0,p.jsx)(y,{recipient:i,amount:o,buttonLoading:e,onWithdraw:I,onClose:()=>{n(!1),m(!1)}}):(0,p.jsx)(j,{recipient:i,amount:o,buttonLoading:e,onPreview:e=>{e.preventDefault(),m(!0)},onRecipientChange:c,onAmountChange:u,onClose:()=>n(!1)})]})]})},w={wrapper:"flex bg-[#121212] min-h-screen flex-col w-full items-center p-4 text-white",profileSection:"flex flex-col gap-1 justify-evenly items-center bg-[#212121] rounded-lg p-4 w-full max-w-4xl mb-6",profilePicture:"h-24 w-24 md:h-32 md:w-32 rounded-full border-2 border-[#8a939b] mb-4",addressContainer:"flex  mb-2",address:"  mb-2 text-center",balance:"text-md text-[#8a939b] mb-4",qrCodeContainer:"flex flex-col items-center",qrCodeLabel:"text-md font-semibold mb-2",nftsSection:"w-full max-w-[90%]  rounded-lg p-4",nftGrid:"flex flex-wrap justify-center gap-1",nftCard:"bg-[#212121] w-[200px] mb-3 rounded-md  overflow-hidden",nftImg:"w-[200px] h-48 ml-[3px] mt-[3px] rounded-t-md cursor-pointer    object-cover",info:"flex justify-between text-white drop-shadow-xl ml-2 mr-2",infoLeft:"flex-0.6 flex-wrap",assetName:"font-bold mt-1"},k=()=>{const[e,t]=(0,r.useState)(null),[s,d]=(0,r.useState)(null),{data:u}=(0,a.I)({queryKey:["userPrincipal"]}),{data:x}=(0,a.I)({queryKey:["userIcpBalance"]}),{data:m}=(0,a.I)({queryKey:["marketplaceActor"]}),{data:f}=(0,a.I)({queryKey:["nftActor"]}),{data:j}=(0,a.I)({queryKey:["userNFTS"]}),y=(0,h.Zp)();(0,r.useEffect)((()=>{if(!u)return;let e=i.nG.fromPrincipal({principal:l.Principal.fromText(u),subAccount:void 0}).toHex();console.log(e),d(e)}),[u]),(0,r.useEffect)((()=>{(async()=>{try{let e=[];if(!u||!m)return;let s=await(null===m||void 0===m?void 0:m.get_all_user_listed_nfts(l.Principal.fromText(u)));if(console.log("heeee :",s.data[0]),200==s.status&&"Ok"==s.status_text&&s.data[0].length>0)for(const t of s.data[0])!0===t.isConfirmed&&e.push({nftid:t.nft_id,type:"Listed",canister_id:t.nft_canister,collectionName:Object.keys(t.nft_category)[0]});let r=i.nG.fromPrincipal({principal:l.Principal.fromText(u),subAccount:void 0}).toHex(),a=await(null===f||void 0===f?void 0:f.tokens(r)),n=Array.from(null===a||void 0===a?void 0:a.ok);if(console.log("ahaha :",n),n&&n.length>0)for(const t of n)e.push({nftid:t,type:"Owned",canister_id:"rw7qm-eiaaa-aaaak-aaiqq-cai",collectionName:"Kitties"});console.log("aaaaa :",e),t(e)}catch(e){console.log("error in fetching user listed NFTs",e)}})()}),[u,m,f,j]);const v=u||"0x1234567890abcdef",k=e=>{navigator.clipboard.writeText(e),alert("Address copied to clipboard!")},C=e=>`${e.slice(0,11)}...${e.slice(-7)}`;return(0,p.jsx)(p.Fragment,{children:u?(0,p.jsxs)("div",{className:w.wrapper,children:[(0,p.jsxs)("div",{className:w.profileSection,children:[(0,p.jsxs)("div",{className:w.addressContainer,children:[(0,p.jsx)("div",{className:w.address,children:v&&C(v)}),(0,p.jsx)(n.As9,{onClick:()=>k(v),className:"cursor-pointer text-lg hover:text-blue-500"})]}),(0,p.jsxs)("div",{className:w.addressContainer,children:[(0,p.jsx)("div",{className:w.address,children:s&&C(s)}),(0,p.jsx)(n.As9,{onClick:()=>k(s),className:"cursor-pointer text-lg hover:text-blue-500"})]}),(0,p.jsx)(N,{})]}),(0,p.jsxs)("div",{className:w.nftsSection,children:[(0,p.jsx)("h2",{className:"text-xl font-semibold mb-4 text-center",children:"My NFTs"}),(0,p.jsx)("div",{className:w.nftGrid,children:e&&e.length>0?e.map(((e,t)=>(0,p.jsxs)("div",{className:w.nftCard,children:[(0,p.jsx)("img",{src:`https://${e.canister_id}.raw.icp0.io/?tokenid=${(0,c.T)(e.nftid,e.canister_id)}&type=thumbnail`,alt:"",onClick:()=>y("Listed"===e.type&&"../marketplace/"+e.canister_id+"/"+e.nftid),className:w.nftImg}),(0,p.jsxs)("div",{className:w.info,children:[(0,p.jsx)("div",{className:w.infoLeft,children:(0,p.jsx)("div",{className:w.collectionName,children:e.collectionName})}),(0,p.jsx)("div",{className:w.infoRight,children:(0,p.jsxs)("div",{className:w.assetName,children:["#",e.nftid," "]})})]}),"Owned"==e.type?(0,p.jsxs)("div",{className:"flex flex-row mt-4 gap-2 justify-center items-center",children:[(0,p.jsx)(b,{nft:e}),(0,p.jsx)(g,{nft:e})]}):(0,p.jsx)(o.A,{nft:(0,c.T)(e.nftid,e.canister_id)})]}))):(0,p.jsxs)("div",{className:w.profileSection,children:[(0,p.jsx)("p",{children:"No NFTs found."}),(0,p.jsx)("p",{children:"Your NFTS will appear here"})]})})]})]}):y("/")})}},5123:(e,t,s)=>{s.d(t,{A:()=>d});var r=s(3747),a=s(7097),n=s(5043),i=s(8973),l=s(710),c=s(2013),o=s(579);const d=e=>{let{nft:t}=e;const[s,d]=(0,n.useState)(""),[u,x]=(0,n.useState)(!1),[m,f]=(0,n.useState)(!1),[p,b]=(0,n.useState)(!1),[h,g]=(0,n.useState)(""),[j,y]=(0,n.useState)(""),{invalidateListings:v,invalidateUserNfts:N}=(0,c.A)(),w=async(e,t)=>{g(e),y(t),b(!0),setTimeout((()=>b(!1)),3e3)},{data:k}=(0,r.I)({queryKey:["userPrincipal"]}),{data:C}=(0,r.I)({queryKey:["userIcpBalance"]}),{data:S}=(0,r.I)({queryKey:["allListings"]}),{data:A}=(0,r.I)({queryKey:["IcpActor"]}),{data:T}=(0,r.I)({queryKey:["userNFTS"]}),{data:I}=(0,r.I)({queryKey:["nftActor"]}),{data:P}=(0,r.I)({queryKey:["marketplaceActor"]}),{mutateAsync:_}=(0,a.n)({mutationFn:()=>q(),onSuccess:async()=>{v(),N(),f(!1)}}),q=async()=>{if(t){f(!0);try{let e=await P.un_list_nft(t.token_identifier);200==e.status&&"Ok"==e.status_text?w("NFT unlisted successfully","success"):w(e.error_text,"error"),console.log("unlisting res :",e)}catch(e){console.log("error in unlisting token :",e)}}};return(0,o.jsxs)("div",{className:"flex flex-col gap-1 w-full",children:[(0,o.jsxs)("div",{className:"flex flex-row gap-4 w-full",children:[(0,o.jsx)("button",{className:"flex bg-[#2E8DEE] w-1/2 rounded-lg mt-4 font-bold text-white justify-center items-center p-2",onClick:()=>x(!0),children:"Unlist"}),(0,o.jsx)("button",{className:"flex bg-[#5e6163] w-1/2 rounded-lg mt-4 font-bold text-white justify-center items-center p-2",onClick:()=>x(!0),children:"Update"})]}),u&&(0,o.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:[p&&(0,o.jsx)("div",{className:"absolute top-10 text-xs z-50  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===j?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,o.jsx)("div",{className:"modal-message",children:(0,o.jsx)("p",{children:h})})}),(0,o.jsxs)("div",{className:"bg-[#252525] rounded-lg shadow-lg p-6 w-96",children:[(0,o.jsxs)("div",{className:"flex justify-between ",children:[(0,o.jsx)("h2",{className:" mb-4",children:"Unlist NFT"}),(0,o.jsx)(i.PXF,{className:"cursor-pointer",onClick:()=>x(!1)})]}),(0,o.jsx)("span",{children:"Remove NFT from the marketplace?"}),(0,o.jsx)("div",{className:"flex justify-end mt-3",children:m?(0,o.jsx)(l.A,{color:"white",size:20}):(0,o.jsx)("button",{onClick:_,className:"px-4 py-2 bg-white text-black rounded",children:"Unlist"})})]})]})]})}}}]);
//# sourceMappingURL=284.1c4477bb.chunk.js.map