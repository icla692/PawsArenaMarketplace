"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[679],{1289:(e,l,t)=>{t.d(l,{T:()=>s});var i=t(2198);function s(e,l){let t=new Uint8Array([10,116,105,100]);const s=i.Principal.fromText(l).toUint8Array();t=new Uint8Array([...t,...s]);let r=e;for(let i=3;i>=0;i--){const e=Math.pow(2,8*i),l=Math.floor(r/e);t=new Uint8Array([...t,l]),r-=l*e}return i.Principal.fromUint8Array(t).toText()}},8657:(e,l,t)=>{t.d(l,{A:()=>x});var i=t(3747),s=t(7097),r=t(5043),a=t(1935),n=t(2198),o=t(710),d=t(2013),c=t(3216),u=t(579);const x=e=>{let{nftid:l,nft_price:t,userP:x}=e;const[h,m]=(0,r.useState)(!1),[v,p]=(0,r.useState)(!1),[f,g]=(0,r.useState)(""),[j,b]=(0,r.useState)(""),{invalidateListings:N,invalidateUserNfts:w,invalidateUserBalance:y}=(0,d.A)(),C=async(e,l)=>{g(e),b(l),p(!0),setTimeout((()=>p(!1)),3e3)},{data:P}=(0,i.I)({queryKey:["userPrincipal"]}),{data:k}=(0,i.I)({queryKey:["userIcpBalance"]}),{data:S}=(0,i.I)({queryKey:["allListings"]}),{data:_}=(0,i.I)({queryKey:["userNFTS"]}),{data:T}=(0,i.I)({queryKey:["nftActor"]}),{data:L}=(0,i.I)({queryKey:["marketplaceActor"]}),{data:M}=(0,i.I)({queryKey:["IcpActor"]}),I=(0,c.Zp)(),{mutateAsync:A}=(0,s.n)({mutationFn:()=>O(),onSuccess:async()=>{N(),w(),y(),m(!1)}}),O=async()=>{try{if(!L)return alert("Log in first to purchase this NFT"),void C("Log in first to purchase this NFT","error");m(!0);let e=await M.icrc2_approve({fee:[],memo:[],from_subaccount:[],created_at_time:[],amount:Number(t)+2e4,expected_allowance:[],expires_at:[],spender:{owner:n.Principal.fromText(a.WC),subaccount:[]}});console.log("approve results :",e);let i=await L.buy_nft(l);200==i.status&&"Ok"==i.status_text?C("NFT purchase successful","success"):C(i.error_text,"error"),console.log("buy results :",i)}catch(e){console.log("error in buying nft :",e)}I("/profile")};return(0,u.jsxs)(u.Fragment,{children:[v&&(0,u.jsx)("div",{className:"absolute top-10 z-50 text-xs  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===j?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,u.jsx)("div",{className:"modal-message",children:(0,u.jsx)("p",{children:f})})}),(0,u.jsx)("button",{onClick:()=>A(),className:"flex w-full bg-[#2E8DEE] rounded-b-lg mt-4 font-bold text-white justify-center items-center p-2",children:h?(0,u.jsx)(o.A,{size:20,color:"white"}):"Buy"})]})}},2156:(e,l,t)=>{t.d(l,{A:()=>o});t(5043);var i=t(8657),s=t(1289),r=t(3216);const a=t.p+"static/media/icplogo.71d22b69911f6dedf410.png";var n=t(579);const o=e=>{var l,t,o;let{collectionID:d,nft:c}=e;const u=(0,r.Zp)();return(0,n.jsxs)("div",{className:" rounded bg-[#202020] w-[250px] m-2 rounded-b-lg",children:[(0,n.jsx)("img",{onClick:()=>u("../marketplace/"+d+"/"+c[0]),src:`https://${d}.raw.icp0.io/?tokenid=${(0,s.T)(c[0],d)}&type=thumbnail`,alt:"NFT",className:"w-[100%] ml-[2.5px] cursor-pointer  object-cover rounded mb-2"}),(0,n.jsxs)("div",{className:"flex w-full px-2 justify-between",children:[(0,n.jsxs)("p",{children:["#",c[0]]}),null!==(l=c[1])&&void 0!==l&&l.price?(0,n.jsxs)("div",{className:"flex gap-1",children:[(0,n.jsx)("img",{src:a,height:"7px",width:"15px",alt:"logo"}),(0,n.jsx)("span",{children:null===(t=Number(null===(o=c[1])||void 0===o?void 0:o.price)/1e8)||void 0===t?void 0:t.toFixed(2)})]}):"unlisted"]}),(0,n.jsx)("div",{className:`opacity-0 ${void 0!=c[1].price&&"hover:opacity-100"} transition-opacity duration-300`,children:(0,n.jsx)(i.A,{nftid:c[0],nft_price:Number(c[1].nft_price),userP:c[1].seller_principal})})]},c.id)}},961:(e,l,t)=>{t.r(l),t.d(l,{default:()=>w});var i=t(826),s=t(5043),r=t(3216),a=t(1935),n=t(1699),o=t(710),d=t(579);const c=e=>{let{collectionData:l,isLoading:t}=e;const[i,r]=(0,s.useState)(!1);return console.log("dddd :",l),(0,d.jsxs)("div",{className:"flex flex-col mt-[80px]",children:[l?(0,d.jsx)("div",{className:"relative rounded w-full object-cover mx-auto",children:(0,d.jsxs)("div",{className:"overflow-hidden h-[200px] w-full",children:[(0,d.jsx)("img",{src:null===l||void 0===l?void 0:l.imgUrl,alt:null===l||void 0===l?void 0:l.name,className:"w-full rounded-lg h-full object-cover"}),(0,d.jsx)("div",{className:"absolute bottom-0 left-0 right-0 text-white p-2",children:(0,d.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-end",children:[(0,d.jsx)("h2",{className:"text-xl font-bold",children:null===l||void 0===l?void 0:l.name}),(0,d.jsxs)("div",{className:"flex  flex-row justify-between gap-4 mt-1",children:[(0,d.jsxs)("div",{className:"flex flex-col",children:[(0,d.jsx)("span",{children:"Volume"}),(0,d.jsxs)("span",{children:[(Number(null===l||void 0===l?void 0:l.volume)/1e11).toFixed(2),"k"]})]}),(0,d.jsxs)("div",{className:"flex flex-col",children:[(0,d.jsx)("span",{children:"Listings"}),(0,d.jsx)("span",{children:Number(null===l||void 0===l?void 0:l.totalListed)})]}),(0,d.jsxs)("div",{className:"flex flex-col",children:[(0,d.jsx)("span",{children:"Floor Price"}),(0,d.jsx)("span",{children:(Number(null===l||void 0===l?void 0:l.floorPrice)/1e8).toFixed(2)})]})]})]})})]})},null===l||void 0===l?void 0:l.canisterId):(0,d.jsx)("div",{className:"flex flex-col mt-[80px] justify-center items-center",children:(0,d.jsx)(o.A,{size:25,color:"white"})}),l&&(0,d.jsxs)("div",{className:"mx-4 p-4 flex flex-col justify-center items-center",children:[(0,d.jsx)("div",{className:"text-white text-center",children:i?null===l||void 0===l?void 0:l.description:`${null===l||void 0===l?void 0:l.description.slice(0,150)}...`}),(0,d.jsx)("button",{onClick:()=>{r(!i)},className:"text-white text-md font-bold flex justify-center items-center hover:underline mt-2",children:i?"See Less":"See More"})]})]})};t(1289),t(8657);var u=t(2156);const x=e=>{let{results:l,isSidebarOpen:t,isLoading:i,minPrice:s,maxPrice:r,handleMinPriceChange:a,handleMaxPriceChange:n}=e;return(0,d.jsxs)("div",{className:"flex  w-full  text-white gap-3 border-gray-400 p-2",children:[t&&(0,d.jsx)("div",{className:"hidden md:block border border-gray-600 p-4 w-1/4",children:(0,d.jsxs)("div",{className:"flex txt-black flex-col mt-4",children:[(0,d.jsx)("span",{children:"Price"}),(0,d.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,d.jsx)("input",{type:"text",placeholder:"Min",value:s,onChange:a,className:"p-1 rounded text-black",required:!0}),(0,d.jsx)("input",{type:"text",placeholder:"Max",value:r,onChange:n,className:"p-1 rounded text-black",required:!0})]}),(0,d.jsx)("div",{className:"flex flex-col mt-4",children:(0,d.jsx)("span",{children:"Traits"})})]})}),(0,d.jsx)("div",{className:"flex flex-col w-full",children:(0,d.jsx)("div",{className:"flex flex-row w-full",children:(0,d.jsx)("div",{className:"flex-grow w-full flex  justify-center items-center flex-wrap",children:i?(0,d.jsx)(o.A,{size:25,color:"white"}):l})})})]})};var h=t(5394);const m=e=>{let{onClickHandler:l,value:t,title:i}=e;return(0,d.jsx)("button",{onClick:l,value:t,className:"btns",children:i})};var v=t(423);const p=e=>{let{currentPage:l,nextPage:t,pages:i,prevPage:s,searchQuery:r,sortPrice:a,isModalOpen:n,toggleSidebar:o,closeModal:c,handlelistedChange:u,handleSortPriceChange:x,handleSearchChange:p,maxPrice:f,minPrice:g,handleMaxPriceChange:j,handleMinPriceChange:b}=e;return(0,d.jsxs)("div",{className:"flex flex-col w-full gap-4 p-2",children:[(0,d.jsxs)("div",{className:"flex mt-[05px] cursor-pointer border-b-[1px] pb-2 border-white flex-row justify-between items-center w-full",children:[(0,d.jsx)(h.n6t,{size:35,color:"white",onClick:o}),(0,d.jsxs)("div",{className:"hidden md:block relative ",children:[(0,d.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:(0,d.jsx)(v.uG9,{color:"gray",size:25})}),(0,d.jsx)("input",{type:"text",className:"hidden md:block bg-transparent border outline-none border-gray-300 text-white rounded-lg w-full pl-10 p-2.5",placeholder:"Search by name or trait",onChange:p,value:r})]}),(0,d.jsx)("div",{className:"hidden md:flex md:flex-row gap-2",children:(0,d.jsxs)("select",{value:a,onChange:x,className:" block bg-transparent  text-white  w-full p-3 border rounded-lg",children:[(0,d.jsx)("option",{value:"lowtohigh",className:"bg-red-400",children:"Price Low to High"}),(0,d.jsx)("option",{value:"hightolow",children:"Price High to Low"})]})})]}),(0,d.jsx)("div",{className:"hidden md:flex-row md:block justify-between items-center cursor-pointer",children:(0,d.jsxs)("div",{className:"flex flex-row justify-between items-center ",children:[(0,d.jsxs)("div",{className:"flex mt-4",children:[(0,d.jsx)(m,{onClickHandler:u,value:"all",title:"All"}),(0,d.jsx)(m,{onClickHandler:u,value:"listed",title:"Listed"}),(0,d.jsx)(m,{onClickHandler:u,value:"hasoffers",title:"Has Offers"})]}),(0,d.jsxs)("div",{className:"flex gap-4 items-center justify-center mt-4",children:[(0,d.jsx)("button",{onClick:s,disabled:0===l,className:"px-4 py-1 bg-transparent border text-white rounded "+(0===l?"opacity-50 cursor-not-allowed":""),children:"Previous"}),(0,d.jsx)("button",{onClick:t,disabled:l>=i-1,className:"px-4 py-1 bg-transparent border text-white rounded "+(l>=i-1?"opacity-50 cursor-not-allowed":""),children:"Next"})]})]})}),n&&(0,d.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-70 flex justify-center items-center z-50",children:(0,d.jsxs)("div",{className:"bg-[#202020] p-4 rounded-lg w-[90%] md:w-[400px]",children:[(0,d.jsxs)("div",{className:"flex w-full justify-between items-center",children:[(0,d.jsx)("h2",{className:"text-lg font-bold text-white mb-2",children:"Filter"}),(0,d.jsx)("button",{onClick:c,className:"text-red-400 font-bold float-right cursor-pointer text-lg",children:"X"})]}),(0,d.jsx)("input",{type:"text",placeholder:"Search by name or trait...",value:r,onChange:p,className:"p-1 rounded outline-none bg-gray-300 border-none mt-6 w-full"}),(0,d.jsx)("div",{className:" md:block  mt-6 justify-between items-center cursor-pointer",children:(0,d.jsxs)("div",{children:[(0,d.jsx)(m,{onClickHandler:u,value:"all",title:"All"}),(0,d.jsx)(m,{onClickHandler:u,value:"listed",title:"Listed"}),(0,d.jsx)(m,{onClickHandler:u,value:"hasoffers",title:"Has Offers"})]})}),(0,d.jsxs)("select",{value:a,onChange:x,className:"mt-4 block bg-gray-300 text-black w-full p-2 border rounded",children:[(0,d.jsx)("option",{value:"lowtohigh",children:"Price Low to High"}),(0,d.jsx)("option",{value:"hightolow",children:"Price High to Low"})]}),(0,d.jsxs)("div",{className:"flex flex-col mt-4",children:[(0,d.jsx)("span",{className:"text-white",children:"Price"}),(0,d.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,d.jsx)("input",{type:"text",placeholder:"Min",value:g,onChange:b,className:"p-1 rounded border-none bg-gray-300 outline-none text-black",required:!0}),(0,d.jsx)("input",{type:"text",placeholder:"Max",value:f,onChange:j,className:"p-1 rounded bg-gray-300 border-none outline-none text-black",required:!0})]}),(0,d.jsx)("div",{className:"flex flex-col mt-4",children:(0,d.jsx)("span",{className:"text-white",children:"Traits"})})]})]})})]})};var f=t(4230),g=t(3248),j=t(3747);const b="ic"!=={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DFX_NETWORK?"https://ic0.app":"http://localhost:4943",N=new i.qB({host:b,retryTimes:10}),w=()=>{const{collectionID:e}=(0,r.g)(),[l,t]=(0,s.useState)(null),[i,o]=(0,s.useState)(""),[h,m]=(0,s.useState)("lowtohigh"),[v,b]=(0,s.useState)("listed"),[w,y]=(0,s.useState)(""),[C,P]=(0,s.useState)(""),[k,S]=(0,s.useState)(!0),[_,T]=(0,s.useState)(0),[L,M]=(0,s.useState)([]),[I,A]=(0,s.useState)([]),[O,F]=(0,s.useState)(!0),[q,D]=(0,s.useState)(!1),H=(0,g.jE)(),{data:E}=(0,j.I)({queryKey:["bulkData"]}),{data:K,isLoading:U}=(0,j.I)({queryKey:["myTokens"]}),{data:z,isLoading:W}=(0,j.I)({queryKey:["collectionDetails"]});(0,s.useEffect)((()=>{(async()=>{S(!0);JSON.parse(localStorage.getItem("bulkData"));let l=JSON.parse(localStorage.getItem("bulkData"));console.log("here is the data :",l),console.log("xxxxxxxx :",z,E);try{var i,s,r;const l=(0,n.M)(a.WC,f.c,N),o=a.Oq.find((l=>l.canisterId===e)),d=await(null===l||void 0===l?void 0:l.get_all_listed_nfts()),c=(null===d||void 0===d||null===(i=d.data[0])||void 0===i?void 0:i.filter((l=>l[1].nft_canister==e)))||[],u=null===c||void 0===c?void 0:c.map((e=>[e[1].nft_id,{locked:[],seller:e[1].seller_principal,price:e[1].nft_price,inhouse_sale:!0}]));let x=null===E||void 0===E?void 0:E.find((l=>l[0]==e)),h=null===z||void 0===z?void 0:z.find((l=>l.canisterId==e));const m=[...u];M(m);const v=Object.fromEntries(m.map((e=>[e[0],e]))),p=null===(s=x[1])||void 0===s||null===(r=s.allNftTokens)||void 0===r?void 0:r.map((e=>v[e[0]]?v[e[0]]:e));console.log("all ttt :",p),A(p),H.setQueryData(["myTokens"],p),o&&t({imgUrl:null===h||void 0===h?void 0:h.imgUrl,canisterId:null===h||void 0===h?void 0:h.canisterId,name:null===h||void 0===h?void 0:h.name,description:null===h||void 0===h?void 0:h.description,volume:null===h||void 0===h?void 0:h.volume,floorPrice:null===h||void 0===h?void 0:h.floorprice,totalListed:null===h||void 0===h?void 0:h.totalListed})}catch(o){console.error("Error loading NFT data:",o)}finally{S(!1)}})()}),[e]);const B=e=>y(e.target.value),R=e=>P(e.target.value);console.log(v,w);const $=(0,s.useMemo)((()=>{var l;let t=[...L];var s,r,a,n,o;i&&(t=null===(s=t)||void 0===s?void 0:s.filter((e=>{var l;return null===(l=e[0])||void 0===l?void 0:l.toString().toLowerCase().includes(i.toLowerCase())})));"listed"===v?t=null===(r=t)||void 0===r?void 0:r.filter((e=>{var l;return null===(l=e[1])||void 0===l?void 0:l.hasOwnProperty("price")})):"all"===v&&(t=I,console.log("all tokens :",I));w&&(t=null===(a=t)||void 0===a?void 0:a.filter((e=>{var l;return Number(null===(l=e[1])||void 0===l?void 0:l.price)/1e8>=parseFloat(w)})));C&&(t=null===(n=t)||void 0===n?void 0:n.filter((e=>{var l;return Number(null===(l=e[1])||void 0===l?void 0:l.price)/1e8<=parseFloat(C)})));h&&(null===(o=t)||void 0===o||o.sort(((e,l)=>"lowtohigh"===h?Number(e[1].price)-Number(l[1].price):Number(l[1].price)-Number(e[1].price))));const c=50*_,x=c+50;return console.log("hhhhhhhhhhhhhhhhhh:",t),null===(l=t)||void 0===l?void 0:l.slice(c,x).map(((l,t)=>(0,d.jsx)(u.A,{nft:l,collectionID:e},t)))}),[L,I,i,h,v,w,C,_]),Q=Math.ceil((null===I||void 0===I?void 0:I.length)/50);return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:"flex flex-col mx-4 md:mx-20 mt-50",children:[(0,d.jsx)(c,{collectionData:l,isLoading:U}),(0,d.jsx)(p,{prevPage:()=>{_>0&&T((e=>e-1))},nextPage:()=>{_<Q-1&&T((e=>e+1))},currentPage:_,sortPrice:h,pages:Q,searchQuery:i,isModalOpen:q,closeModal:()=>D(!1),maxPrice:C,minPrice:w,handleMaxPriceChange:R,handleMinPriceChange:B,toggleSidebar:()=>{window.innerWidth<768?D(!0):F((e=>!e))},handleSearchChange:e=>o(e.target.value),handleSortPriceChange:e=>m(e.target.value),handlelistedChange:e=>b((l=>e.target.value))}),(0,d.jsx)(x,{results:$,isLoading:U,maxPrice:C,minPrice:w,isSidebarOpen:O,isModalOpen:q,handleMaxPriceChange:R,handleMinPriceChange:B,closeModal:()=>D(!1)})]})})}}}]);
//# sourceMappingURL=679.276e4912.chunk.js.map