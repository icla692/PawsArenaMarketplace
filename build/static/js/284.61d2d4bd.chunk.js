"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[284],{1289:(e,t,s)=>{s.d(t,{T:()=>l});var i=s(2198);function l(e,t){let s=new Uint8Array([10,116,105,100]);const l=i.Principal.fromText(t).toUint8Array();s=new Uint8Array([...s,...l]);let n=e;for(let i=3;i>=0;i--){const e=Math.pow(2,8*i),t=Math.floor(n/e);s=new Uint8Array([...s,t]),n-=t*e}return i.Principal.fromUint8Array(s).toText()}},6551:(e,t,s)=>{s.d(t,{A:()=>x});var i=s(7097),l=s(5043),n=s(8973),r=s(8247),a=s(2013),o=s(1699),c=s(1935),d=s(39),u=s(4230),f=s(579);const x=e=>{let{nft:t,handleTrigger:s}=e;const[x,m]=(0,l.useState)(!1),[p,h]=(0,l.useState)(""),[g,b]=(0,l.useState)(!1),{invalidateListings:v}=(0,a.A)(),[j,N]=(0,l.useState)(!1),w=(0,d.fJ)(),{user:y}=(0,d._d)(),[k,S]=(0,l.useState)(!1),[T,_]=(0,l.useState)(""),[A,C]=(0,l.useState)(""),F=async(e,t)=>{_(e),C(t),S(!0),setTimeout((()=>S(!1)),3e3)},{mutateAsync:I}=(0,i.n)({mutationFn:e=>P(e),onSuccess:async()=>{v()}}),P=async e=>{e.preventDefault();let i=(0,o.M)(c.WC,u.c,w);if(console.log("new price : ",p,t),!i)return void F("login first","error");if(!p||0==p||!t)return;N(!0),b(!0);let l=await(null===i||void 0===i?void 0:i.update_nft_price(t,parseInt(1e8*p)));200==(null===l||void 0===l?void 0:l.status)&&"Ok"==(null===l||void 0===l?void 0:l.status_text)?F("price updated successfully","success"):F(null===l||void 0===l?void 0:l.error_text,"error"),s(),N(!1),b(!1)};return(0,f.jsxs)("div",{className:"flex flex-col gap-1 w-1/2",children:[k&&(0,f.jsx)("div",{className:"absolute text-xs top-5 z-50  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===A?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,f.jsx)("div",{className:"modal-message",children:(0,f.jsx)("p",{children:T})})}),(0,f.jsx)("button",{className:"flex bg-[#6fa0d1] w-full rounded-lg mt-4 font-bold text-white justify-center items-center p-2",onClick:()=>m(!0),children:"Update"}),x&&(0,f.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:(0,f.jsxs)("div",{className:"bg-[#252525] rounded-lg shadow-lg p-6 w-96",children:[(0,f.jsxs)("div",{className:"flex justify-between ",children:[(0,f.jsx)("h2",{className:" mb-4",children:"Update NFT price"}),(0,f.jsx)(n.PXF,{className:"cursor-pointer",onClick:()=>m(!1)})]}),(0,f.jsxs)("form",{onSubmit:I,children:[(0,f.jsx)("input",{type:"number",id:"price",value:p,placeholder:"enter new nft price",onChange:e=>h(e.target.value),className:" border border-white text-black rounded p-1 w-full mb-4",required:!0}),(0,f.jsx)("div",{className:"flex justify-end",children:g?(0,f.jsx)(r.A,{color:"white",size:20}):(0,f.jsx)("button",{type:"submit",className:"px-4 py-2 bg-white text-black rounded",children:"update"})})]})]})})]})}},9284:(e,t,s)=>{s.r(t),s.d(t,{default:()=>T});var i=s(5043),l=s(3747),n=s(3248),r=(s(1614),s(6246),s(3825)),a=s(2126),o=s(2198),c=s(1289),d=s(5772),u=s(7097),f=s(8973),x=s(8247),m=s(1935),p=s(2013),h=s(39),g=s(1699),b=s(4230),v=s(7586),j=s(579);const N=e=>{let{nft:t,handleTrigger:s}=e;const[n,r]=(0,i.useState)(!1),[a,d]=(0,i.useState)(0),[N,w]=(0,i.useState)(!1),{invalidateListings:y}=(0,p.A)(),k=(0,h.fJ)(),[S,T]=(0,i.useState)(!1),[_,A]=(0,i.useState)(""),[C,F]=(0,i.useState)(""),I=async(e,t)=>{A(e),F(t),T(!0),setTimeout((()=>T(!1)),3e3)},{data:P}=(0,l.I)({queryKey:["userPrincipal"]}),{user:q}=(0,h._d)(),{mutateAsync:z}=(0,u.n)({mutationFn:e=>E(e),onSuccess:async()=>{y(),w(!1)}}),E=async e=>{if(e.preventDefault(),!q||!t||!k)return;let i=(0,g.M)(m.WC,b.c,k),l=(0,g.M)(m.qY,v.c,k);if(0!=a){w(!0);try{let e=await(null===i||void 0===i?void 0:i.init_list_nft(q.principal,t.nftid,{Kitties:null},parseInt(1e8*a)));console.log("init res:",e);let s=(0,c.T)(t.nftid,t.canister_id),n=await(null===l||void 0===l?void 0:l.transfer({amount:parseInt(1),from:{principal:q.principal},memo:[],notify:!1,subaccount:[],to:{principal:o.Principal.fromText(m.WC)},token:s}));console.log("transfer result:",n);let r=await(null===i||void 0===i?void 0:i.complete_listing(null===q||void 0===q?void 0:q.principal,t.nftid,{Kitties:null}));console.log("final listing:",r),200==(null===r||void 0===r?void 0:r.status)&&"Ok"==(null===r||void 0===r?void 0:r.status_text)?I("NFT listed successfully","success"):I(r.error_text,"error")}catch(n){console.log("Error in listing NFT:",n)}s()}else alert("price is zero")};return(0,j.jsxs)("div",{className:"relative flex-row gap-1 flex w-full font-bold text-white justify-center items-center p-2 ",children:[(0,j.jsx)("button",{className:"flex bg-[#2E8DEE] w-full rounded-lg mt-4 font-bold text-white justify-center items-center p-2",onClick:()=>r(!0),children:"List"}),n&&(0,j.jsxs)("div",{className:"fixed inset-0 p-4 flex items-center justify-center z-50 bg-black bg-opacity-50",children:[S&&(0,j.jsx)("div",{className:"absolute top-10 text-xs z-50  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===C?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,j.jsx)("div",{className:"modal-message",children:(0,j.jsx)("p",{children:_})})}),(0,j.jsxs)("div",{className:"bg-[#252525] rounded-lg shadow-lg p-6 w-96",children:[(0,j.jsxs)("div",{className:"flex justify-between ",children:[(0,j.jsx)("h2",{className:"text-xl font-bold mb-4",children:"List NFT"}),(0,j.jsx)(f.PXF,{className:"cursor-pointer",onClick:()=>r(!1)})]}),(0,j.jsxs)("form",{onSubmit:z,children:[(0,j.jsx)("label",{className:"block mb-2",htmlFor:"price",children:"Enter listing price"}),(0,j.jsx)("input",{type:"number",id:"price",value:a,onChange:e=>d(e.target.value),className:" border border-white text-black rounded p-1 w-full mb-4",required:!0}),(0,j.jsx)("div",{className:"flex justify-end",children:N?(0,j.jsx)(x.A,{color:"white",size:20}):(0,j.jsx)("button",{type:"submit",className:"px-4 py-2 bg-white text-black rounded",children:"Confirm listing"})})]})]})]})]})};var w=s(3216);const y=e=>{let{nft:t,handleTrigger:s}=e;const[l,n]=(0,i.useState)(!1),[r,a]=(0,i.useState)(!1),[o,d]=(0,i.useState)(""),[b,N]=(0,i.useState)(!1),{invalidateListings:w}=(0,p.A)(),y=(0,h.fJ)(),{user:k}=(0,h._d)(),[S,T]=(0,i.useState)(!1),[_,A]=(0,i.useState)(""),[C,F]=(0,i.useState)(""),I=async(e,t)=>{A(e),F(t),T(!0),setTimeout((()=>T(!1)),3e3)},{mutateAsync:P}=(0,u.n)({mutationFn:e=>q(e),onSuccess:async()=>{w(),N(!1)}}),q=async e=>{e.preventDefault(),N(!0),console.log("nft :",t);let i=(0,g.M)(m.qY,v.c,y);i&&t||I("please login first","success");let l=(0,c.T)(Number(t.nftid),t.canister_id),n=await i.transfer({amount:parseInt(1),from:{principal:k.principal},memo:[],notify:!1,subaccount:[],to:{address:o},token:l});n.ok?I("NFT transfer successful","success"):I(n.err,"error"),s(),console.log("transfer success",n)};return(0,j.jsxs)("div",{className:"relative flex-row gap-1 flex w-full font-bold text-white justify-center items-center p-2 ",children:[(0,j.jsx)("button",{className:"flex bg-[#2E8DEE] w-full rounded-lg mt-4 font-bold text-white justify-center items-center p-2",onClick:()=>n(!0),children:"Transfer"}),l&&(0,j.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:[S&&(0,j.jsx)("div",{className:"absolute top-10 text-xs z-50  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===C?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,j.jsx)("div",{className:"modal-message",children:(0,j.jsx)("p",{children:_})})}),(0,j.jsxs)("div",{className:"bg-[#252525] rounded-lg shadow-lg p-6 w-96",children:[(0,j.jsxs)("div",{className:"flex justify-between ",children:[(0,j.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Transfer NFT"}),(0,j.jsx)(f.PXF,{className:"cursor-pointer",onClick:()=>n(!1)})]}),(0,j.jsxs)("form",{onSubmit:P,children:[(0,j.jsx)("input",{type:"text",id:"recipient",placeholder:"enter recipient account",value:o,onChange:e=>d(e.target.value),className:" border border-white text-black rounded p-1 w-full mb-4",required:!0}),(0,j.jsx)("div",{className:"flex justify-end",children:b?(0,j.jsx)(x.A,{color:"white",size:20}):(0,j.jsx)("button",{type:"submit",className:"px-4 py-2 bg-white text-black rounded",children:"Transfer"})})]})]})]})]})};var k=s(6551);const S={wrapper:"flex mt-[80px] h-screen bg-[#121212] flex-col w-full items-center p-4 text-white",profileSection:"flex flex-col border rounded-lg w-full max-w-2xl mb-6",addressContainer:"flex flex-row gap-2 items-center justify-center",address:"  mt-20 mb-2 text-center",balance:"text-md text-[#8a939b] mb-4",qrCodeContainer:"flex flex-col items-center",qrCodeLabel:"text-md font-semibold mb-2",nftsSection:"w-full  rounded-lg p-4",nftGrid:"flex flex-wrap justify-center gap-1",nftCard:"bg-[#212121] w-[200px] mb-3 rounded-md  overflow-hidden relative",nftImg:"w-[200px] h-48 ml-[3px] mt-[3px] rounded-t-md cursor-pointer object-cover",info:"flex justify-between text-white drop-shadow-xl ml-2 mr-2",infoLeft:"flex-0.6 flex-wrap",assetName:"font-bold mt-1",buttonsContainer:"absolute bottom-5 left-0 right-0 flex flex-row gap-2 justify-center items-center p-2 opacity-0 hover:opacity-100 "},T=()=>{var e,t;const[s,u]=(0,i.useState)(null),[f,m]=(0,i.useState)(null),[p,g]=(0,i.useState)(""),{user:b}=(0,h._d)(),{data:v}=(0,l.I)({queryKey:["userPrincipal"]}),{data:T}=(0,l.I)({queryKey:["userIcpBalance"]}),{data:_}=(0,l.I)({queryKey:["marketplaceActor"]}),{data:A}=(0,l.I)({queryKey:["nftActor"]}),{data:C}=(0,l.I)({queryKey:["IcpActor"]}),F=(0,w.Zp)();(0,n.jE)();(0,i.useEffect)((()=>{if(!v)return;let e=a.nG.fromPrincipal({principal:o.Principal.fromText(v),subAccount:void 0}).toHex();console.log(e),m(e)}),[v]),(0,i.useEffect)((()=>{(async()=>{try{let e=[];if(!v||!_)return;let t=await(null===_||void 0===_?void 0:_.get_all_user_listed_nfts(o.Principal.fromText(v)));if(console.log("heeee :",t.data[0]),200==t.status&&"Ok"==t.status_text&&t.data[0].length>0)for(const n of t.data[0])!0===n.isConfirmed&&e.push({nftid:n.nft_id,type:"Listed",canister_id:n.nft_canister,collectionName:Object.keys(n.nft_category)[0]});let s=a.nG.fromPrincipal({principal:o.Principal.fromText(v),subAccount:void 0}).toHex(),i=await(null===A||void 0===A?void 0:A.tokens(s)),l=Array.from(null===i||void 0===i?void 0:i.ok);if(console.log("ahaha :",l),l&&l.length>0)for(const n of l)e.push({nftid:n,type:"Owned",canister_id:"rw7qm-eiaaa-aaaak-aaiqq-cai",collectionName:"Kitties"});u(e)}catch(e){console.log("error in fetching user listed NFTs",e)}})()}),[b,p]);const I=e=>g(Math.random()),P=e=>{navigator.clipboard.writeText(e),alert("Address copied to clipboard!")},q=(e,t)=>`${e.slice(0,t)}...${e.slice(-7)}`;return(0,j.jsx)(j.Fragment,{children:null!==b&&void 0!==b&&b.principal?(0,j.jsxs)("div",{className:S.wrapper,children:[(0,j.jsxs)("div",{className:S.profileSection,children:[(0,j.jsx)("div",{className:"flex rounded-t-md text-black font-bold px-4 bg-white",children:"Overview"}),(0,j.jsxs)("div",{className:"flex flex-col md:flex-row gap-2 w-full ",children:[(0,j.jsxs)("div",{className:" flex flex-col px-4 py-2 w-full",children:[(0,j.jsx)("span",{className:"font-bold",children:"Wallet ID:"}),(null===b||void 0===b?void 0:b.principal)&&(0,j.jsxs)("div",{className:"flex flex-row gap-2  items-center",children:[(0,j.jsx)("span",{className:"flex flex-row justify-center items-center",children:q(null===b||void 0===b||null===(e=b.principal)||void 0===e?void 0:e.toString(),20)}),(0,j.jsx)(r.As9,{size:25,className:"cursor-pointer border rounded-md p-1 hover:text-lg",onClick:()=>{var e;return P(null===b||void 0===b||null===(e=b.principal)||void 0===e?void 0:e.toText())}})]})]}),(0,j.jsxs)("div",{className:" flex flex-col px-4 py-2 w-full",children:[(0,j.jsx)("span",{className:"font-bold",children:"Balance:"}),(0,j.jsx)("div",{className:"flex flex-row gap-2  items-center",children:(0,j.jsxs)("span",{className:"flex justify-center items-center",children:[T||(0,j.jsx)(x.A,{size:15,color:"white"})," ICP"]})})]})]}),(0,j.jsxs)("div",{className:" flex flex-col px-4 py-2 w-full",children:[(0,j.jsx)("span",{className:"font-bold",children:"Account Identifier:"}),null!==b&&void 0!==b&&b.principal?(0,j.jsxs)("div",{className:"flex flex-row gap-2  items-center",children:[(0,j.jsx)("span",{children:q(null===(t=a.nG.fromPrincipal({principal:b.principal}))||void 0===t?void 0:t.toHex(),18)}),(0,j.jsx)(r.As9,{size:25,className:"cursor-pointer border rounded-md p-1 hover:text-lg",onClick:()=>{var e;return P(null===(e=a.nG.fromPrincipal({principal:b.principal}))||void 0===e?void 0:e.toHex())}})]}):(0,j.jsx)(x.A,{})]})]}),(0,j.jsxs)("div",{className:S.nftsSection,children:[(0,j.jsx)("h2",{className:"text-xl font-semibold mb-4 text-center",children:"My NFTs"}),(0,j.jsx)("div",{className:S.nftGrid,children:s&&(null===s||void 0===s?void 0:s.length)>0?null===s||void 0===s?void 0:s.map(((e,t)=>(0,j.jsxs)("div",{className:`${S.nftCard} ${S.nftCardHover}`,children:[(0,j.jsx)("img",{src:`https://${e.canister_id}.raw.icp0.io/?tokenid=${(0,c.T)(e.nftid,e.canister_id)}&type=thumbnail`,alt:"",onClick:()=>F("Listed"===e.type&&"../marketplace/"+e.canister_id+"/"+e.nftid),className:S.nftImg}),(0,j.jsxs)("div",{className:S.info,children:[(0,j.jsx)("div",{className:S.infoLeft,children:(0,j.jsx)("div",{className:S.collectionName,children:e.collectionName})}),(0,j.jsx)("div",{className:S.infoRight,children:(0,j.jsxs)("div",{className:S.assetName,children:["#",e.nftid," "]})})]}),(0,j.jsx)("div",{className:S.buttonsContainer,children:"Owned"==e.type?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(N,{nft:e,handleTrigger:I}),(0,j.jsx)(y,{nft:e,handleTrigger:I})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(d.A,{nft:(0,c.T)(e.nftid,e.canister_id),handleTrigger:I}),(0,j.jsx)(k.A,{nft:(0,c.T)(e.nftid,e.canister_id),handleTrigger:I})]})})]}))):(0,j.jsxs)("div",{className:S.profileSection,children:[(0,j.jsx)("p",{children:"No NFTs found."}),(0,j.jsx)("p",{children:"Your NFTS will appear here"})]})})]})]}):F("/")})}},5772:(e,t,s)=>{s.d(t,{A:()=>m});var i=s(7097),l=s(5043),n=s(8973),r=s(8247),a=s(2013),o=s(39),c=s(1935),d=s(4230),u=s(1699),f=s(3216),x=s(579);const m=e=>{let{nft:t,handleTrigger:s}=e;const[m,p]=(0,l.useState)(!1),[h,g]=(0,l.useState)(!1),[b,v]=(0,l.useState)(!1),[j,N]=(0,l.useState)(""),[w,y]=(0,l.useState)(""),{invalidateListings:k,invalidateUserNfts:S}=(0,a.A)(),T=(0,o.fJ)(),_=(0,f.Zp)(),A=async(e,t)=>{N(e),y(t),v(!0),setTimeout((()=>v(!1)),3e3)},{mutateAsync:C}=(0,i.n)({mutationFn:()=>F(),onSuccess:async()=>{k(),S(),g(!1)}}),F=async()=>{let e=(0,u.M)(c.WC,d.c,T);if(t&&e){g(!0);try{console.log("unlist :",t);let i=await(null===e||void 0===e?void 0:e.un_list_nft(t));200==(null===i||void 0===i?void 0:i.status)&&"Ok"==(null===i||void 0===i?void 0:i.status_text)?A("NFT unlisted successfully","success"):A(null===i||void 0===i?void 0:i.error_text,"error"),s(),_("/profile"),console.log("unlisting res :",i)}catch(i){console.log("error in unlisting token :",i)}}};return(0,x.jsxs)("div",{className:"flex flex-col gap-1 w-1/2",children:[(0,x.jsx)("div",{className:"flex flex-row gap-4",children:(0,x.jsx)("button",{className:"flex bg-[#2c2d2e] rounded-lg w-full mt-4 font-bold text-white justify-center items-center p-2 cursor-pointer",onClick:()=>p(!0),children:"Unlist"})}),m&&(0,x.jsxs)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:[b&&(0,x.jsx)("div",{className:"absolute top-10 text-xs z-50  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===w?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,x.jsx)("div",{className:"modal-message",children:(0,x.jsx)("p",{children:j})})}),(0,x.jsxs)("div",{className:"bg-[#252525] rounded-lg shadow-lg p-6 w-96",children:[(0,x.jsxs)("div",{className:"flex justify-between ",children:[(0,x.jsx)("h2",{className:" mb-4",children:"Unlist NFT"}),(0,x.jsx)(n.PXF,{className:"cursor-pointer",onClick:()=>p(!1)})]}),(0,x.jsx)("span",{children:"Remove NFT from the marketplace?"}),(0,x.jsx)("div",{className:"flex justify-end mt-3",children:h?(0,x.jsx)(r.A,{color:"white",size:20}):(0,x.jsx)("button",{onClick:C,className:"px-4 py-2 bg-white text-black rounded",children:"Unlist"})})]})]})]})}}}]);
//# sourceMappingURL=284.61d2d4bd.chunk.js.map