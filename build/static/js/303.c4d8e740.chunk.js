"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[303],{8657:(t,e,r)=>{r.d(e,{A:()=>p});var s=r(3747),n=r(7097),i=r(5043),a=r(1935),o=r(2198),c=r(710),u=r(2013),l=r(3216),d=r(579);const p=t=>{let{nftid:e,nft_price:r,userP:p}=t;const[h,m]=(0,i.useState)(!1),[f,x]=(0,i.useState)(!1),[y,b]=(0,i.useState)(""),[v,g]=(0,i.useState)(""),{invalidateListings:j,invalidateUserNfts:w,invalidateUserBalance:O}=(0,u.A)(),N=async(t,e)=>{b(t),g(e),x(!0),setTimeout((()=>x(!1)),3e3)},{data:I}=(0,s.I)({queryKey:["userPrincipal"]}),{data:C}=(0,s.I)({queryKey:["userIcpBalance"]}),{data:M}=(0,s.I)({queryKey:["allListings"]}),{data:k}=(0,s.I)({queryKey:["userNFTS"]}),{data:_}=(0,s.I)({queryKey:["nftActor"]}),{data:R}=(0,s.I)({queryKey:["marketplaceActor"]}),{data:K}=(0,s.I)({queryKey:["IcpActor"]}),S=(0,l.Zp)(),{mutateAsync:E}=(0,n.n)({mutationFn:()=>q(),onSuccess:async()=>{j(),w(),O(),m(!1)}}),q=async()=>{try{if(!R)return alert("Log in first to purchase this NFT"),void N("Log in first to purchase this NFT","error");m(!0);let t=await K.icrc2_approve({fee:[],memo:[],from_subaccount:[],created_at_time:[],amount:Number(r)+2e4,expected_allowance:[],expires_at:[],spender:{owner:o.Principal.fromText(a.WC),subaccount:[]}});console.log("approve results :",t);let s=await R.buy_nft(e);200==s.status&&"Ok"==s.status_text?N("NFT purchase successful","success"):N(s.error_text,"error"),console.log("buy results :",s)}catch(t){console.log("error in buying nft :",t)}S("/profile")};return(0,d.jsxs)(d.Fragment,{children:[f&&(0,d.jsx)("div",{className:"absolute top-10 z-50 text-xs  left-1/2 transform -translate-x-1/2 transition-transform duration-500 ease-out "+("success"===v?"bg-green-100 text-green-800 border border-green-300 rounded-lg p-1 animate-slide-in":"bg-red-100 text-red-800 border border-red-300 rounded-lg p-1 animate-slide-in"),children:(0,d.jsx)("div",{className:"modal-message",children:(0,d.jsx)("p",{children:y})})}),(0,d.jsx)("button",{onClick:()=>E(),className:"flex w-full bg-[#2E8DEE] rounded-b-lg mt-4 font-bold text-white justify-center items-center p-2",children:h?(0,d.jsx)(c.A,{size:20,color:"white"}):"Buy"})]})}},1303:(t,e,r)=>{r.r(e),r.d(e,{default:()=>l});var s=r(3248),n=r(3747),i=(r(5043),r(1935),r(8657)),a=r(3216),o=r(579);const c={wrapper:"bg-[#212121] w-[200px] mb-3 rounded-md overflow-hidden group",imgContainer:"h-40 bg-red-400 sm:h-32 md:h-36 w-full bg-[#121212] flex justify-center items-center overflow-hidden",nftImg:"w-[200px] h-48 ml-[3px] mt-[3px] rounded-t-md cursor-pointer object-cover",info:"flex justify-between text-white drop-shadow-xl ml-2 mr-2",infoLeft:"flex-0.6 flex-wrap",collectionName:"font-semibold text-xs sm:text-sm md:text-base lg:text-lg text-white",assetName:"font-bold mt-1",infoRight:"flex-0.4 text-right",priceTag:"font-semibold text-xs sm:text-sm md:text-base lg:text-lg text-white",priceValue:"flex items-center text-lg sm:text-xl md:text-2xl font-bold mt-1",ethLogo:"h-5 mr-2",likes:"text-[#8a939b] font-bold flex items-center w-full justify-end mt-2",likeIcon:"text-xl mr-2",buyButtonContainer:"opacity-0 group-hover:opacity-100 transition-opacity duration-300"},u=t=>{let{nft:e}=t;const{data:r}=(0,n.I)({queryKey:["userPrincipal"]}),s=(0,a.Zp)();return(0,o.jsxs)("div",{className:c.wrapper,children:[(0,o.jsx)("img",{src:`https://${e[1].nft_canister}.raw.icp0.io/?tokenid=${e[1].token_identifier}&type=thumbnail`,alt:"",onClick:()=>s("../marketplace/"+e[1].nft_canister+"/"+e[1].nft_id),className:c.nftImg}),(0,o.jsxs)("div",{className:c.details,children:[(0,o.jsxs)("div",{className:c.info,children:[(0,o.jsxs)("div",{className:c.infoLeft,children:[(0,o.jsx)("div",{className:c.collectionName,children:Object.keys(e[1].nft_category)}),(0,o.jsxs)("div",{className:c.priceTag,children:[Number(e[1].nft_price)/1e8," ICP"]})]}),(0,o.jsx)("div",{className:c.infoRight,children:(0,o.jsxs)("div",{className:c.assetName,children:["#",e[1].nft_id," "]})})]}),(0,o.jsx)("div",{className:c.buyButtonContainer,children:(0,o.jsx)(i.A,{nftid:e[0],nft_price:Number(e[1].nft_price),userP:e[1].seller_principal})})]})]})},l=()=>{const t=(0,a.Zp)(),{data:e}=((0,s.jE)(),(0,n.I)({queryKey:["userPrincipal"]})),{data:r}=(0,n.I)({queryKey:["allListings"]}),{data:i}=(0,n.I)({queryKey:["userIcpBalance"]}),{data:c}=(0,n.I)({queryKey:["marketplaceActor"]}),{data:l}=(0,n.I)({queryKey:["nftActor"]}),{data:d}=(0,n.I)({queryKey:["userAccountId"]});return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"flex bg-[#121212] flex-col py-2 min-h-screen  items-center w-full",children:e?(0,o.jsx)("div",{className:"flex px-4 flex-wrap justify-center md:justify-start items-center gap-3",children:r&&(null===r||void 0===r?void 0:r.map(((t,e)=>(0,o.jsxs)("div",{className:"",children:[" ",(0,o.jsx)(u,{nft:t,index:e})]},e))))}):t("/")})})}},710:(t,e,r)=>{r.d(e,{A:()=>u});var s=r(5043),n={cm:!0,mm:!0,in:!0,px:!0,pt:!0,pc:!0,em:!0,ex:!0,ch:!0,rem:!0,vw:!0,vh:!0,vmin:!0,vmax:!0,"%":!0};function i(t){var e=function(t){if("number"===typeof t)return{value:t,unit:"px"};var e,r=(t.match(/^[0-9.]*/)||"").toString();e=r.includes(".")?parseFloat(r):parseInt(r,10);var s=(t.match(/[^0-9]*$/)||"").toString();return n[s]?{value:e,unit:s}:(console.warn("React Spinners: ".concat(t," is not a valid css value. Defaulting to ").concat(e,"px.")),{value:e,unit:"px"})}(t);return"".concat(e.value).concat(e.unit)}var a=function(){return a=Object.assign||function(t){for(var e,r=1,s=arguments.length;r<s;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},a.apply(this,arguments)},o=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]])}return r},c=function(t,e,r){var s="react-spinners-".concat(t,"-").concat(r);if("undefined"==typeof window||!window.document)return s;var n=document.createElement("style");document.head.appendChild(n);var i=n.sheet,a="\n    @keyframes ".concat(s," {\n      ").concat(e,"\n    }\n  ");return i&&i.insertRule(a,0),s}("ClipLoader","0% {transform: rotate(0deg) scale(1)} 50% {transform: rotate(180deg) scale(0.8)} 100% {transform: rotate(360deg) scale(1)}","clip");const u=function(t){var e=t.loading,r=void 0===e||e,n=t.color,u=void 0===n?"#000000":n,l=t.speedMultiplier,d=void 0===l?1:l,p=t.cssOverride,h=void 0===p?{}:p,m=t.size,f=void 0===m?35:m,x=o(t,["loading","color","speedMultiplier","cssOverride","size"]),y=a({background:"transparent !important",width:i(f),height:i(f),borderRadius:"100%",border:"2px solid",borderTopColor:u,borderBottomColor:"transparent",borderLeftColor:u,borderRightColor:u,display:"inline-block",animation:"".concat(c," ").concat(.75/d,"s 0s infinite linear"),animationFillMode:"both"},h);return r?s.createElement("span",a({style:y},x)):null}},7097:(t,e,r)=>{r.d(e,{n:()=>d});var s=r(5043),n=r(5239),i=r(1454),a=r(329),o=r(9723),c=class extends a.Q{#t;#e=void 0;#r;#s;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){const e=this.options;this.options=this.#t.defaultMutationOptions(t),(0,o.f8)(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#r,observer:this}),e?.mutationKey&&this.options.mutationKey&&(0,o.EN)(e.mutationKey)!==(0,o.EN)(this.options.mutationKey)?this.reset():"pending"===this.#r?.state.status&&this.#r.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#r?.removeObserver(this)}onMutationUpdate(t){this.#n(),this.#i(t)}getCurrentResult(){return this.#e}reset(){this.#r?.removeObserver(this),this.#r=void 0,this.#n(),this.#i()}mutate(t,e){return this.#s=e,this.#r?.removeObserver(this),this.#r=this.#t.getMutationCache().build(this.#t,this.options),this.#r.addObserver(this),this.#r.execute(t)}#n(){const t=this.#r?.state??(0,n.$)();this.#e={...t,isPending:"pending"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset}}#i(t){i.j.batch((()=>{if(this.#s&&this.hasListeners()){const e=this.#e.variables,r=this.#e.context;"success"===t?.type?(this.#s.onSuccess?.(t.data,e,r),this.#s.onSettled?.(t.data,null,e,r)):"error"===t?.type&&(this.#s.onError?.(t.error,e,r),this.#s.onSettled?.(void 0,t.error,e,r))}this.listeners.forEach((t=>{t(this.#e)}))}))}},u=r(3248),l=r(3247);function d(t,e){const r=(0,u.jE)(e),[n]=s.useState((()=>new c(r,t)));s.useEffect((()=>{n.setOptions(t)}),[n,t]);const a=s.useSyncExternalStore(s.useCallback((t=>n.subscribe(i.j.batchCalls(t))),[n]),(()=>n.getCurrentResult()),(()=>n.getCurrentResult())),o=s.useCallback(((t,e)=>{n.mutate(t,e).catch(l.l)}),[n]);if(a.error&&(0,l.G)(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:o,mutateAsync:a.mutate}}}}]);
//# sourceMappingURL=303.c4d8e740.chunk.js.map